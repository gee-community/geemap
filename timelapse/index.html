
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python package for interactive mapping with Google Earth Engine">
      
      
        <meta name="author" content="Qiusheng Wu">
      
      
        <link rel="canonical" href="https://geemap.org/timelapse/">
      
      
        <link rel="prev" href="../report/">
      
      
        <link rel="next" href="../toolbar/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>timelapse module - geemap</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-H322CB6ZEC"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-H322CB6ZEC",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-H322CB6ZEC",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#timelapse-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="geemap" class="md-header__button md-logo" aria-label="geemap" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            geemap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              timelapse module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/gee-community/geemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="geemap" class="md-nav__button md-logo" aria-label="geemap" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    geemap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gee-community/geemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://book.geemap.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Book
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../get-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheat Sheet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://courses.geemap.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Courses
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../citations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Citations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://youtube.com/@giswqs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YouTube Channel
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/gee-community/geemap/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report Issues
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" checked>
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ai module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basemaps module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cartoee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cartoee module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chart module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../colormaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    colormaps module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    common module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conversion module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coreutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coreutils module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deck module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ee_tile_layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ee_tile_layers module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    examples module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../foliumap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foliumap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geemap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geemap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kepler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kepler module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../legends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    legends module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../map_widgets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    map_widgets module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibregl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maplibregl module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ml module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../osm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    osm module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotlymap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plotlymap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    report module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    timelapse module
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    timelapse module
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      geemap.timelapse
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_image_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_image_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_overlay" class="md-nav__link">
    <span class="md-ellipsis">
      add_overlay()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_progress_bar_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_progress_bar_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_text_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_text_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.create_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      create_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.create_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      create_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.dynamic_world_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic_world_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.gif_fading" class="md-nav__link">
    <span class="md-ellipsis">
      gif_fading()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.gif_to_mp4" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_mp4()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.gif_to_png" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_png()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_fire_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      goes_fire_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_fire_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      goes_fire_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      goes_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      goes_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timelapse_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timelapse_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timeseries_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timeseries_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_ts_norm_diff" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_ts_norm_diff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_ts_norm_diff_gif" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_ts_norm_diff_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.make_gif" class="md-nav__link">
    <span class="md-ellipsis">
      make_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.merge_gifs" class="md-nav__link">
    <span class="md-ellipsis">
      merge_gifs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ndvi_doy_ts" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ndvi_doy_ts()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ndvi_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ndvi_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ocean_color_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ocean_color_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ocean_color_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ocean_color_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      modis_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.naip_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      naip_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.naip_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      naip_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.reduce_gif_size" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_gif_size()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_filtering" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_filtering()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_timelapse_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_timelapse_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel2_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel2_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel2_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel2_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel2_timeseries_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel2_timeseries_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.vector_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_gif()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../toolbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolbar module
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workshops
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GeoPython_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoPython 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SRM_Workshop_2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SRM Workshop 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Crop_Mapping_2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crop Mapping 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Japan_2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Japan 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2022_Part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2022 Part1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2022_Part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2022 Part2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/AmericaView_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AmericaView 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SciPy_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SciPy 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/City_Plus_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    City Plus 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/G4G_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    G4G 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/NCSU_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NCSU 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/AGU_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AGU 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Alaska_2024_Part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alaska 2024 Part1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Alaska_2024_Part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alaska 2024 Part2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Alaska_2024_Part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alaska 2024 Part3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/TNGIC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TNGIC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/IGIC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IGIC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SciPy_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SciPy 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SatMOC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SatMOC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GeoAI_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoAI 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Taiwan_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taiwan 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/FOSS4GNA_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FOSS4GNA 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/IPPN_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPPN 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/HGAC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HGAC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/AGU_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AGU 2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notebooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_ee_auth_colab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 ee auth colab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_geemap_colab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 geemap colab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_geemap_key_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 geemap key features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/01_geemap_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 geemap intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/02_using_basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 using basemaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/03_inspector_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03 inspector tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/04_split_panel_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 split panel map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/05_drawing_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 drawing tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/06_marker_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06 marker cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/07_geojson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07 geojson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/08_ee_js_to_ipynb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08 ee js to ipynb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/09_plotting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09 plotting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/10_shapefiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10 shapefiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/11_export_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11 export image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/12_zonal_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12 zonal statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/13_zonal_statistics_by_group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13 zonal statistics by group
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/14_legends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14 legends
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/15_convert_js_to_py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15 convert js to py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/16_add_animated_text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16 add animated text
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/17_add_colorbar_to_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17 add colorbar to gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/18_create_landsat_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18 create landsat timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/19_search_places_and_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    19 search places and datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/20_timeseries_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20 timeseries inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/21_export_map_to_html_png/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21 export map to html png
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/22_import_scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22 import scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/23_import_assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23 import assets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/24_publish_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    24 publish maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/25_load_rasters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25 load rasters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/26_heroku/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26 heroku
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/27_timelapse_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27 timelapse app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/28_voila/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    28 voila
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/29_pydeck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    29 pydeck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/30_image_props_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    30 image props stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/31_unsupervised_classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    31 unsupervised classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/32_supervised_classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    32 supervised classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/33_accuracy_assessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    33 accuracy assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/34_extract_values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    34 extract values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/35_geemap_colab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    35 geemap colab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/36_quality_mosaic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    36 quality mosaic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/37_pydeck_3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    37 pydeck 3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/38_cloud_geotiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    38 cloud geotiff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/39_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    39 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/40_ipywidgets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    40 ipywidgets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/41_water_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    41 water app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/42_upload_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    42 upload data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/43_extract_values_to_points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    43 extract values to points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/44_cog_stac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    44 cog stac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/45_cog_mosaic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    45 cog mosaic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/46_local_rf_training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    46 local rf training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/47_image_thumbnails/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    47 image thumbnails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/48_folium_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    48 folium legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/49_colorbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    49 colorbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/50_cartoee_quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    50 cartoee quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/51_cartoee_projections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    51 cartoee projections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/52_cartoee_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    52 cartoee gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/53_layer_vis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    53 layer vis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/54_vector_vis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    54 vector vis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/55_raster_vis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    55 raster vis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/56_local_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    56 local data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/57_cartoee_blend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    57 cartoee blend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/58_add_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    58 add vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/59_whitebox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    59 whitebox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/60_colormaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    60 colormaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/61_cartoee_scalebar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    61 cartoee scalebar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/62_time_slider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    62 time slider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/63_charts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    63 charts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/64_data_catalog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    64 data catalog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/65_vector_styling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    65 vector styling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/66_cartoee_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    66 cartoee legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/67_training_samples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    67 training samples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/68_netcdf_to_ee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    68 netcdf to ee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/69_cartoee_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    69 cartoee vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/70_linked_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    70 linked maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/71_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    71 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/72_time_slider_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    72 time slider gui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/73_transect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    73 transect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/74_csv_to_points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    74 csv to points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/75_sankee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    75 sankee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/76_osm_to_ee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    76 osm to ee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/77_planet_imagery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    77 planet imagery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/78_ts_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    78 ts inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/79_chart_histogram/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    79 chart histogram
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/80_point_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    80 point layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/81_goes_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    81 goes timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/82_contours/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    82 contours
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/83_local_tile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    83 local tile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/84_openstreetmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    84 openstreetmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/85_postgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    85 postgis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/86_image_overlay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    86 image overlay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/87_add_points_from_xy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    87 add points from xy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/88_circle_markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    88 circle markers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/89_add_labels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    89 add labels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/90_naip_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    90 naip timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/91_planetary_computer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    91 planetary computer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/92_plotly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    92 plotly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/93_cog_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    93 cog inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/94_heremap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    94 heremap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/95_create_cog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    95 create cog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/96_image_chips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    96 image chips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/97_join_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    97 join table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/98_timelapse_fading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    98 timelapse fading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/99_landsat_9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    99 landsat 9
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/100_numpy_to_cog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    100 numpy to cog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/101_lidar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    101 lidar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/102_blend_hillshade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    102 blend hillshade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/103_split_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    103 split control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/104_clip_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    104 clip image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/105_netcdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    105 netcdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/106_kepler_gl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    106 kepler gl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/107_pydeck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    107 pydeck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/108_image_zonal_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    108 image zonal stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/109_coordinate_grids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    109 coordinate grids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/110_choropleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    110 choropleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/111_image_count/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    111 image count
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/112_cartoee_basemap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    112 cartoee basemap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/113_image_area/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    113 image area
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/114_dynamic_world/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    114 dynamic world
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/115_land_cover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    115 land cover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/116_land_cover_timeseries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    116 land cover timeseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/117_fishnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    117 fishnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/118_download_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    118 download image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/119_plot_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    119 plot raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/120_javascript/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    120 javascript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/121_vector_style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    121 vector style
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/122_lidar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    122 lidar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/123_sentinel1_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    123 sentinel1 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/124_more_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    124 more datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/125_example_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    125 example code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/126_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    126 inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/127_create_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    127 create legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/128_add_widget/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    128 add widget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/129_vector_to_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    129 vector to gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/130_print_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    130 print objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/131_arcgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    131 arcgis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/132_folium_colorbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    132 folium colorbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/133_gradio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    133 gradio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/134_ee_to_geotiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    134 ee to geotiff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/135_segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    135 segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/136_download_parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    136 download parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/137_create_grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    137 create grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/138_draw_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    138 draw control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/139_layer_to_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    139 layer to image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/140_ee_to_xarray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    140 ee to xarray
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/141_image_array_viz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    141 image array viz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/142_google_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    142 google maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/143_precipitation_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    143 precipitation timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/144_chart_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    144 chart features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/145_chart_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    145 chart image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/146_chart_image_collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    146 chart image collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/147_chart_array_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    147 chart array list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/148_chart_data_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    148 chart data table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/149_gemini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    149 gemini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/150_maplibre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    150 maplibre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/151_dataset_explorer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    151 dataset explorer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      geemap.timelapse
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_image_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_image_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_overlay" class="md-nav__link">
    <span class="md-ellipsis">
      add_overlay()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_progress_bar_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_progress_bar_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.add_text_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_text_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.create_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      create_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.create_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      create_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.dynamic_world_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic_world_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.gif_fading" class="md-nav__link">
    <span class="md-ellipsis">
      gif_fading()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.gif_to_mp4" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_mp4()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.gif_to_png" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_png()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_fire_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      goes_fire_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_fire_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      goes_fire_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      goes_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.goes_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      goes_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timelapse_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timelapse_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_timeseries_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_timeseries_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_ts_norm_diff" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_ts_norm_diff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.landsat_ts_norm_diff_gif" class="md-nav__link">
    <span class="md-ellipsis">
      landsat_ts_norm_diff_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.make_gif" class="md-nav__link">
    <span class="md-ellipsis">
      make_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.merge_gifs" class="md-nav__link">
    <span class="md-ellipsis">
      merge_gifs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ndvi_doy_ts" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ndvi_doy_ts()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ndvi_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ndvi_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ocean_color_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ocean_color_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_ocean_color_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      modis_ocean_color_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.modis_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      modis_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.naip_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      naip_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.naip_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      naip_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.reduce_gif_size" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_gif_size()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_filtering" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_filtering()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_timelapse_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_timelapse_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel1_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel1_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel2_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel2_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel2_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel2_timeseries()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.sentinel2_timeseries_legacy" class="md-nav__link">
    <span class="md-ellipsis">
      sentinel2_timeseries_legacy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.timelapse.vector_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_gif()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  

  
  


<h1 id="timelapse-module">timelapse module<a class="headerlink" href="#timelapse-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="geemap.timelapse"></a>
    <div class="doc doc-contents first">

      <p>Module for creating timelapse from Earth Engine data.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.add_image_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_image_to_gif</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">in_image</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">circle_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.timelapse.add_image_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds an image logo to a GIF image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>Input file path to the GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>Output file path to the GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>in_image</code></td>
        <td><code>str</code></td>
        <td><p>Input file path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>image_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Resize image. Defaults to (80, 80).</p></td>
        <td><code>(80, 80)</code></td>
      </tr>
      <tr>
        <td><code>circle_mask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply a circle mask to the image. This only works with non-png images. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_image_to_gif</span><span class="p">(</span>
    <span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">in_image</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">circle_mask</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds an image logo to a GIF image.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): Input file path to the GIF image.</span>
<span class="sd">        out_gif (str): Output file path to the GIF image.</span>
<span class="sd">        in_image (str): Input file path to the image.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        image_size (tuple, optional): Resize image. Defaults to (80, 80).</span>
<span class="sd">        circle_mask (bool, optional): Whether to apply a circle mask to the image. This only works with non-png images. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># import io</span>
    <span class="kn">import</span> <span class="nn">warnings</span>

    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageSequence</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>

    <span class="n">is_url</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">in_image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">is_url</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_url</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_image</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided logo file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">check_dir</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">gif</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An error occurred while opening the image.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">logo_raw_image</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">in_image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">logo_raw_image</span> <span class="o">=</span> <span class="n">open_image_from_url</span><span class="p">(</span><span class="n">in_image</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_image</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_image</span><span class="p">)</span>
            <span class="n">logo_raw_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_image</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">logo_raw_size</span> <span class="o">=</span> <span class="n">logo_raw_image</span><span class="o">.</span><span class="n">size</span>

    <span class="n">ratio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">image_resize</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">ratio</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">ratio</span><span class="p">))</span>
    <span class="n">image_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">min</span><span class="p">(</span>
        <span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">logo_image</span> <span class="o">=</span> <span class="n">logo_raw_image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
    <span class="n">logo_image</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>

    <span class="n">gif_width</span><span class="p">,</span> <span class="n">gif_height</span> <span class="o">=</span> <span class="n">gif</span><span class="o">.</span><span class="n">size</span>
    <span class="n">mask_im</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">circle_mask</span><span class="p">:</span>
        <span class="n">mask_im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">mask_im</span><span class="p">)</span>
        <span class="n">draw</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">has_transparency</span><span class="p">(</span><span class="n">logo_raw_image</span><span class="p">):</span>
        <span class="n">mask_im</span> <span class="o">=</span> <span class="n">logo_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># default logo location is 5% width and 5% height of the image.</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gif_width</span> <span class="o">-</span> <span class="n">image_resize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gif_height</span> <span class="o">-</span> <span class="n">image_resize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span>
        <span class="c1"># xy = (int(0.05 * gif_width), int(0.05 * gif_height))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xy must be a tuple, e.g., (10, 10), (&#39;10%&#39;, &#39;10%&#39;)&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">gif_width</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">gif_height</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;xy is out of bounds. x must be within [0, </span><span class="si">{}</span><span class="s2">], and y must be within [0, </span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">gif_width</span><span class="p">,</span> <span class="n">gif_height</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">gif_width</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">gif_height</span><span class="p">)</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The specified xy is invalid. It must be formatted like this (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
                <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;The specified xy is invalid. It must be formatted like this: (10, 10) or (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">gif</span><span class="p">)):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">logo_image</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">mask_im</span><span class="p">)</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

        <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.add_overlay" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_overlay</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.timelapse.add_overlay" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds an overlay to an image collection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection</code></td>
        <td><code>ee.ImageCollection</code></td>
        <td><p>The image collection to add the overlay to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>str | ee.Geometry | ee.FeatureCollection</code></td>
        <td><p>The overlay data to add to the image collection. It can be an HTTP URL to a GeoJSON file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>color</code></td>
        <td><code>str</code></td>
        <td><p>The color of the overlay. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>The width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry | ee.FeatureCollection</code></td>
        <td><p>The region of interest to add the overlay to. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>An ImageCollection with the overlay added.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_overlay</span><span class="p">(</span>
    <span class="n">collection</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">],</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds an overlay to an image collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        collection (ee.ImageCollection): The image collection to add the overlay to.</span>
<span class="sd">        overlay_data (str | ee.Geometry | ee.FeatureCollection): The overlay data to add to the image collection. It can be an HTTP URL to a GeoJSON file.</span>
<span class="sd">        color (str, optional): The color of the overlay. Defaults to &#39;black&#39;.</span>
<span class="sd">        width (int, optional): The width of the overlay. Defaults to 1.</span>
<span class="sd">        opacity (float, optional): The opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        region (ee.Geometry | ee.FeatureCollection, optional): The region of interest to add the overlay to. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: An ImageCollection with the overlay added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Some common administrative boundaries.</span>
    <span class="n">public_assets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;continents&quot;</span><span class="p">,</span> <span class="s2">&quot;countries&quot;</span><span class="p">,</span> <span class="s2">&quot;us_states&quot;</span><span class="p">,</span> <span class="s2">&quot;china&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The collection must be an ee.ImageCollection.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">overlay_data</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">public_assets</span><span class="p">:</span>
                    <span class="n">overlay_data</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;users/giswqs/public/</span><span class="si">{</span><span class="n">overlay_data</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">overlay_data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">overlay_data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
                    <span class="s2">&quot;.geojson&quot;</span>
                <span class="p">):</span>
                    <span class="n">overlay_data</span> <span class="o">=</span> <span class="n">geojson_to_ee</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">overlay_data</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The overlay_data must be a valid ee.FeatureCollection, a valid ee.FeatureCollection asset id, or http url to a geojson file.&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Feature</span><span class="p">):</span>
            <span class="n">overlay_data</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">([</span><span class="n">overlay_data</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
            <span class="n">overlay_data</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">([</span><span class="n">ee</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">overlay_data</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;The overlay_data must be a valid ee.FeatureCollection or a valid ee.FeatureCollection asset id.&quot;</span>
            <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">overlay_data</span> <span class="o">=</span> <span class="n">overlay_data</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>

        <span class="n">empty</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">()</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">empty</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="s2">&quot;featureCollection&quot;</span><span class="p">:</span> <span class="n">overlay_data</span><span class="p">,</span>
                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="n">check_color</span><span class="p">(</span><span class="n">color</span><span class="p">),</span> <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="n">opacity</span><span class="p">})</span>
        <span class="n">blend_col</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">blend_col</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in add_overlay:&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.add_progress_bar_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_progress_bar_to_gif</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#geemap.timelapse.add_progress_bar_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds a progress bar to a GIF image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>duration</code></td>
        <td><code>int</code></td>
        <td><p>controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation.. Defaults to 100.</p></td>
        <td><code>100</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_progress_bar_to_gif</span><span class="p">(</span>
    <span class="n">in_gif</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a progress bar to a GIF image.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The file path to the input GIF image.</span>
<span class="sd">        out_gif (str): The file path to the output GIF image.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        duration (int, optional): controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation.. Defaults to 100.</span>
<span class="sd">        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">io</span>
    <span class="kn">import</span> <span class="nn">warnings</span>

    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageSequence</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="n">progress_bar_color</span> <span class="o">=</span> <span class="n">check_color</span><span class="p">(</span><span class="n">progress_bar_color</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;An error occurred while opening the gif.&quot;</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">n_frames</span>
    <span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="n">progress_bar_widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">count</span> <span class="o">*</span> <span class="n">W</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">progress_bar_shapes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">H</span> <span class="o">-</span> <span class="n">progress_bar_height</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">H</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">progress_bar_widths</span>
    <span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over each frame in the animated image</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">)):</span>
            <span class="c1"># Draw the text on the frame</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="c1"># w, h = draw.textsize(text[index])</span>
            <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">progress_bar_shapes</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">draw</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="c1"># https://www.pythoninformer.com/python-libraries/pillow/creating-animated-gif/</span>
        <span class="c1"># Save the frames as a new image</span>

        <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.add_text_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_text_to_gif</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#geemap.timelapse.add_text_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds animated text to a GIF image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;#000000&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>duration</code></td>
        <td><code>int</code></td>
        <td><p>controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation.. Defaults to 100.</p></td>
        <td><code>100</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_text_to_gif</span><span class="p">(</span>
    <span class="n">in_gif</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds animated text to a GIF image.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The file path to the input GIF image.</span>
<span class="sd">        out_gif (str): The file path to the output GIF image.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        duration (int, optional): controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation.. Defaults to 100.</span>
<span class="sd">        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># import io</span>
    <span class="kn">import</span> <span class="nn">warnings</span>

    <span class="kn">import</span> <span class="nn">pkg_resources</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span><span class="p">,</span> <span class="n">ImageSequence</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s2">&quot;geemap&quot;</span><span class="p">,</span> <span class="s2">&quot;geemap.py&quot;</span><span class="p">))</span>
    <span class="n">default_font</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/fonts/arial.ttf&quot;</span><span class="p">)</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">font_type</span> <span class="o">==</span> <span class="s2">&quot;arial.ttf&quot;</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">font_type</span> <span class="o">==</span> <span class="s2">&quot;alibaba.otf&quot;</span><span class="p">:</span>
        <span class="n">default_font</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/fonts/alibaba.otf&quot;</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">font_list</span> <span class="o">=</span> <span class="n">system_fonts</span><span class="p">(</span><span class="n">show_full_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">font_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">font_list</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">font_type</span> <span class="ow">in</span> <span class="n">font_list</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">font_type</span> <span class="ow">in</span> <span class="n">font_names</span><span class="p">):</span>
                <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">font_type</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The specified font type could not be found on your system. Using the default font instead.&quot;</span>
                <span class="p">)</span>
                <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>

    <span class="n">color</span> <span class="o">=</span> <span class="n">check_color</span><span class="p">(</span><span class="n">font_color</span><span class="p">)</span>
    <span class="n">progress_bar_color</span> <span class="o">=</span> <span class="n">check_color</span><span class="p">(</span><span class="n">progress_bar_color</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An error occurred while opening the gif.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">count</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">n_frames</span>
    <span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="n">progress_bar_widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">count</span> <span class="o">*</span> <span class="n">W</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">progress_bar_shapes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">H</span> <span class="o">-</span> <span class="n">progress_bar_height</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">H</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">progress_bar_widths</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># default text location is 5% width and 5% height of the image.</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xy must be a tuple, e.g., (10, 10), (&#39;10%&#39;, &#39;10%&#39;)&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">W</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;xy is out of bounds. x must be within [0, </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s2">], and y must be within [0, </span><span class="si">{</span><span class="n">H</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">W</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The specified xy is invalid. It must be formatted like this (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The specified xy is invalid. It must be formatted like this: (10, 10) or (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="n">text_sequence</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">text_sequence</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="n">text_sequence</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">text_sequence</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">)</span> <span class="o">!=</span> <span class="n">count</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The length of the text sequence must be equal to the number (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">) of frames in the gif.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">text_sequence</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over each frame in the animated image</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">)):</span>
            <span class="c1"># Draw the text on the frame</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="c1"># w, h = draw.textsize(text[index])</span>
            <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">add_progress_bar</span><span class="p">:</span>
                <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">progress_bar_shapes</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">draw</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="c1"># https://www.pythoninformer.com/python-libraries/pillow/creating-animated-gif/</span>
        <span class="c1"># Save the frames as a new image</span>

        <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.create_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_timelapse</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorbar_width</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">colorbar_height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">colorbar_label_weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">colorbar_tick_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colorbar_bg_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">colorbar_dpi</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">colorbar_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.create_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a timelapse from any ee.ImageCollection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection</code></td>
        <td><code>str | ee.ImageCollection</code></td>
        <td><p>The collection of images to create a timeseries from. It can be a string representing the collection ID or an ee.ImageCollection object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of band names to use in the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>The frequency of the timeseries. It must be one of the following: 'year', 'month', 'day', 'hour', 'minute', 'second'. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to use to reduce the collection of images to a single value. It can be one of the following: 'median', 'mean', 'min', 'max', 'variance', 'sum'. Defaults to 'median'.</p></td>
        <td><code>&#39;median&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to 'YYYY-MM-dd'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to render a single-band image in the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>add_colorbar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a colorbar to the timelapse. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>colorbar_width</code></td>
        <td><code>float</code></td>
        <td><p>Width of the colorbar. Defaults to 6.0.</p></td>
        <td><code>6.0</code></td>
      </tr>
      <tr>
        <td><code>colorbar_height</code></td>
        <td><code>float</code></td>
        <td><p>Height of the colorbar. Defaults to 0.4.</p></td>
        <td><code>0.4</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for the colorbar. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar label. Defaults to 12.</p></td>
        <td><code>12</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label_weight</code></td>
        <td><code>str</code></td>
        <td><p>Font weight for the colorbar label. Defaults to 'normal'.</p></td>
        <td><code>&#39;normal&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_tick_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar ticks. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>colorbar_bg_color</code></td>
        <td><code>str</code></td>
        <td><p>Background color for the colorbar, can be color like "white", "black". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_orientation</code></td>
        <td><code>str</code></td>
        <td><p>Orientation of the colorbar. Defaults to 'horizontal'.</p></td>
        <td><code>&#39;horizontal&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_dpi</code></td>
        <td><code>str</code></td>
        <td><p>DPI for the colorbar, can be numbers like 100, 300. Defaults to 'figure'.</p></td>
        <td><code>&#39;figure&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the colorbar. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Size of the colorbar. It can be formatted like this: (300, 300). Defaults to (300, 300).</p></td>
        <td><code>(300, 300)</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create an mp4 file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>parallel_scale</code></td>
        <td><code>int</code></td>
        <td><p>A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step size to use when creating the date sequence. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the timelapse gif.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_timelapse</span><span class="p">(</span>
    <span class="n">collection</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">,</span>
    <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">colorbar_width</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span>
    <span class="n">colorbar_height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">colorbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">colorbar_label_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">colorbar_tick_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">colorbar_bg_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">colorbar_dpi</span><span class="o">=</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span>
    <span class="n">colorbar_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a timelapse from any ee.ImageCollection.</span>

<span class="sd">    Args:</span>
<span class="sd">        collection (str | ee.ImageCollection): The collection of images to create a timeseries from. It can be a string representing the collection ID or an ee.ImageCollection object.</span>
<span class="sd">        start_date (str): The start date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        end_date (str): The end date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        region (ee.Geometry, optional): The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</span>
<span class="sd">        bands (list, optional): A list of band names to use in the timelapse. Defaults to None.</span>
<span class="sd">        frequency (str, optional): The frequency of the timeseries. It must be one of the following: &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;, &#39;minute&#39;, &#39;second&#39;. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional):  The reducer to use to reduce the collection of images to a single value. It can be one of the following: &#39;median&#39;, &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, &#39;variance&#39;, &#39;sum&#39;. Defaults to &#39;median&#39;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        out_gif (str): The output gif file path. Defaults to None.</span>
<span class="sd">        palette (list, optional): A list of colors to render a single-band image in the timelapse. Defaults to None.</span>
<span class="sd">        vis_params (dict, optional): A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        add_colorbar (bool, optional): Whether to add a colorbar to the timelapse. Defaults to False.</span>
<span class="sd">        colorbar_width (float, optional): Width of the colorbar. Defaults to 6.0.</span>
<span class="sd">        colorbar_height (float, optional): Height of the colorbar. Defaults to 0.4.</span>
<span class="sd">        colorbar_label (str, optional): Label for the colorbar. Defaults to None.</span>
<span class="sd">        colorbar_label_size (int, optional): Font size for the colorbar label. Defaults to 12.</span>
<span class="sd">        colorbar_label_weight (str, optional): Font weight for the colorbar label. Defaults to &#39;normal&#39;.</span>
<span class="sd">        colorbar_tick_size (int, optional): Font size for the colorbar ticks. Defaults to 10.</span>
<span class="sd">        colorbar_bg_color (str, optional): Background color for the colorbar, can be color like &quot;white&quot;, &quot;black&quot;. Defaults to None.</span>
<span class="sd">        colorbar_orientation (str, optional): Orientation of the colorbar. Defaults to &#39;horizontal&#39;.</span>
<span class="sd">        colorbar_dpi (str, optional): DPI for the colorbar, can be numbers like 100, 300. Defaults to &#39;figure&#39;.</span>
<span class="sd">        colorbar_xy (tuple, optional): Lower left corner of the colorbar. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        colorbar_size (tuple, optional): Size of the colorbar. It can be formatted like this: (300, 300). Defaults to (300, 300).</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to create an mp4 file. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>
<span class="sd">        parallel_scale (int, optional): A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</span>
<span class="sd">        step (int, optional): The step size to use when creating the date sequence. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the timelapse gif.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geemap.colormaps</span> <span class="k">as</span> <span class="nn">cm</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;The collection must be an ee.ImageCollection object or asset id.&quot;</span>
            <span class="p">)</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">create_timeseries</span><span class="p">(</span>
        <span class="n">collection</span><span class="p">,</span>
        <span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">bands</span><span class="o">=</span><span class="n">bands</span><span class="p">,</span>
        <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">,</span>
        <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">,</span>
        <span class="n">parallel_scale</span><span class="o">=</span><span class="n">parallel_scale</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># rename the bands to remove the &#39;_reducer&#39; characters from the band names.</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">reducer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bands</span> <span class="o">=</span> <span class="n">names</span><span class="p">[:</span><span class="mi">3</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="n">bands</span><span class="p">]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The bands must be a string or a list of strings.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">palette</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The palette must be a string or a list of strings.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span><span class="o">.</span><span class="n">nominalScale</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">min_value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
            <span class="n">image_min_value</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">image_max_value</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">bands</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">min_value</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="n">max_value</span><span class="p">}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">palette</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">palette</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">palettes</span><span class="o">.</span><span class="n">ndvi</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vis_params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;bands&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">:</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span>
        <span class="k">if</span> <span class="s2">&quot;min&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span><span class="o">.</span><span class="n">nominalScale</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                <span class="n">image_min_value</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;max&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span><span class="o">.</span><span class="n">nominalScale</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="n">image_max_value</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">palette</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;palette&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">):</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">palettes</span><span class="o">.</span><span class="n">ndvi</span>
        <span class="k">elif</span> <span class="n">palette</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;palette&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">):</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">palette</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="s2">&quot;palette&quot;</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The vis_params must be a dictionary.&quot;</span><span class="p">)</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">vis_params</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">),</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
            <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
        <span class="p">)</span>

    <span class="n">video_args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dimensions</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;framesPerSecond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frames_per_second</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>

    <span class="c1"># if crs is not None:</span>
    <span class="c1">#     video_args[&quot;crs&quot;] = crs</span>

    <span class="k">if</span> <span class="s2">&quot;palette&quot;</span> <span class="ow">in</span> <span class="n">vis_params</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vis-gray&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">dimensions</span> <span class="o">&gt;</span> <span class="mi">768</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">dim</span> <span class="o">&gt;</span> <span class="mi">768</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))))</span>
    <span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">out_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))))</span><span class="si">}</span><span class="s2">.jpg&quot;</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">get_image_collection_thumbnails</span><span class="p">(</span>
            <span class="n">col</span><span class="p">,</span>
            <span class="n">out_dir</span><span class="p">,</span>
            <span class="n">vis_params</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">],</span>
            <span class="p">},</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">make_gif</span><span class="p">(</span>
            <span class="n">names</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">fps</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">clean_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">video_args</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">add_text_to_gif</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="n">title_xy</span><span class="p">,</span>
            <span class="n">text_sequence</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
            <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
            <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
            <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
            <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
            <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
            <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
        <span class="n">add_text_to_gif</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span>
            <span class="n">text_sequence</span><span class="o">=</span><span class="n">text_sequence</span><span class="p">,</span>
            <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
            <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
            <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
            <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
            <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
            <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
            <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">add_colorbar</span><span class="p">:</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">save_colorbar</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">colorbar_width</span><span class="p">,</span>
            <span class="n">colorbar_height</span><span class="p">,</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">],</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">],</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">colorbar_label</span><span class="p">,</span>
            <span class="n">label_size</span><span class="o">=</span><span class="n">colorbar_label_size</span><span class="p">,</span>
            <span class="n">label_weight</span><span class="o">=</span><span class="n">colorbar_label_weight</span><span class="p">,</span>
            <span class="n">tick_size</span><span class="o">=</span><span class="n">colorbar_tick_size</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="n">colorbar_bg_color</span><span class="p">,</span>
            <span class="n">orientation</span><span class="o">=</span><span class="n">colorbar_orientation</span><span class="p">,</span>
            <span class="n">dpi</span><span class="o">=</span><span class="n">colorbar_dpi</span><span class="p">,</span>
            <span class="n">show_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">add_image_to_gif</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">colorbar</span><span class="p">,</span> <span class="n">colorbar_xy</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
        <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
        <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
        <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out_gif</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.create_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_timeseries</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.create_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a timeseries from a collection of images by a specified frequency and reducer.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection</code></td>
        <td><code>str | ee.ImageCollection</code></td>
        <td><p>The collection of images to create a timeseries from. It can be a string representing the collection ID or an ee.ImageCollection object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The list of bands to use to create the timeseries. It must be a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>The frequency of the timeseries. It must be one of the following: 'year', 'month', 'day', 'hour', 'minute', 'second'. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to use to reduce the collection of images to a single value. It can be one of the following: 'median', 'mean', 'min', 'max', 'variance', 'sum'. Defaults to 'median'.</p></td>
        <td><code>&#39;median&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to 'YYYY-MM-dd'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>parallel_scale</code></td>
        <td><code>int</code></td>
        <td><p>A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step size to use when creating the date sequence. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>The timeseries.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_timeseries</span><span class="p">(</span>
    <span class="n">collection</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">,</span>
    <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
    <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a timeseries from a collection of images by a specified frequency and reducer.</span>

<span class="sd">    Args:</span>
<span class="sd">        collection (str | ee.ImageCollection): The collection of images to create a timeseries from. It can be a string representing the collection ID or an ee.ImageCollection object.</span>
<span class="sd">        start_date (str): The start date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        end_date (str): The end date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        region (ee.Geometry, optional): The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</span>
<span class="sd">        bands (list, optional): The list of bands to use to create the timeseries. It must be a list of strings. Defaults to None.</span>
<span class="sd">        frequency (str, optional): The frequency of the timeseries. It must be one of the following: &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;, &#39;minute&#39;, &#39;second&#39;. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional):  The reducer to use to reduce the collection of images to a single value. It can be one of the following: &#39;median&#39;, &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, &#39;variance&#39;, &#39;sum&#39;. Defaults to &#39;median&#39;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        parallel_scale (int, optional): A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</span>
<span class="sd">        step (int, optional): The step size to use when creating the date sequence. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: The timeseries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;The collection must be an ee.ImageCollection object or asset id.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span>

    <span class="n">feq_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quarter&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;week&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM-dd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM-dd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM-dd HH&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minute&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM-dd HH:mm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;second&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM-dd HH:mm:ss&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">date_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date_format</span> <span class="o">=</span> <span class="n">feq_dict</span><span class="p">[</span><span class="n">frequency</span><span class="p">]</span>

    <span class="n">dates</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">date_format</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">reducer</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ee.Reducer.</span><span class="si">{</span><span class="n">reducer</span><span class="si">}</span><span class="s2">()&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided reducer is invalid.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_image</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sub_col</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">sub_col</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub_col</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span>
                <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span>
                    <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">ObjectType</span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">),</span>
                    <span class="n">sub_col</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="p">)</span><span class="o">.</span><span class="n">clipToCollection</span><span class="p">(</span><span class="n">region</span><span class="p">),</span>
                    <span class="n">sub_col</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">region</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
                <span class="s2">&quot;empty&quot;</span><span class="p">:</span> <span class="n">sub_col</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">create_image</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">drop_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">images</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s2">&quot;empty&quot;</span><span class="p">,</span> <span class="s2">&quot;equals&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">images</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.dynamic_world_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dynamic_world_timeseries</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2016-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2021-12-31&#39;</span><span class="p">,</span> <span class="n">cloud_pct</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;hillshade&#39;</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.dynamic_world_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create Dynamic World timeseries.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry | ee.FeatureCollection</code></td>
        <td><p>The region of interest.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str | ee.Date</code></td>
        <td><p>The start date of the query. Default to "2016-01-01".</p></td>
        <td><code>&#39;2016-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str | ee.Date</code></td>
        <td><p>The end date of the query. Default to "2021-12-31".</p></td>
        <td><code>&#39;2021-12-31&#39;</code></td>
      </tr>
      <tr>
        <td><code>cloud_pct</code></td>
        <td><code>int</code></td>
        <td><p>The cloud percentage threshold (&lt;=). Defaults to 30.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>The frequency of the timeseries. It must be one of the following: 'year', 'month', 'day', 'hour', 'minute', 'second'. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to be used. Defaults to "mode".</p></td>
        <td><code>&#39;mode&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to 'YYYY-MM-dd'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>The type of image to be returned. Can be one of 'hillshade', 'visualize', 'class', or 'probability'. Default to "hillshade".</p></td>
        <td><code>&#39;hillshade&#39;</code></td>
      </tr>
      <tr>
        <td><code>parallel_scale</code></td>
        <td><code>int</code></td>
        <td><p>A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>An ImageCollection of the Dynamic World land cover timeseries.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dynamic_world_timeseries</span><span class="p">(</span>
    <span class="n">region</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2016-01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2021-12-31&quot;</span><span class="p">,</span>
    <span class="n">cloud_pct</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span>
    <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;hillshade&quot;</span><span class="p">,</span>
    <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create Dynamic World timeseries.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (ee.Geometry | ee.FeatureCollection): The region of interest.</span>
<span class="sd">        start_date (str | ee.Date): The start date of the query. Default to &quot;2016-01-01&quot;.</span>
<span class="sd">        end_date (str | ee.Date): The end date of the query. Default to &quot;2021-12-31&quot;.</span>
<span class="sd">        cloud_pct (int, optional): The cloud percentage threshold (&lt;=). Defaults to 30.</span>
<span class="sd">        frequency (str, optional): The frequency of the timeseries. It must be one of the following: &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;, &#39;minute&#39;, &#39;second&#39;. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional): The reducer to be used. Defaults to &quot;mode&quot;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        return_type (str, optional): The type of image to be returned. Can be one of &#39;hillshade&#39;, &#39;visualize&#39;, &#39;class&#39;, or &#39;probability&#39;. Default to &quot;hillshade&quot;.</span>
<span class="sd">        parallel_scale (int, optional): A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: An ImageCollection of the Dynamic World land cover timeseries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;hillshade&quot;</span><span class="p">,</span> <span class="s2">&quot;visualize&quot;</span><span class="p">,</span> <span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">return_type</span><span class="si">}</span><span class="s2"> must be one of &#39;hillshade&#39;, &#39;visualize&#39;, &#39;class&#39;, or &#39;probability&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Feature</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> must be one of ee.FeatureCollection, ee.Feature, or ee.Geometry.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">cloud_pct</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">cloud_pct</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cloud_pct</span><span class="si">}</span><span class="s2"> must be between 0 and 100.&quot;</span><span class="p">)</span>

    <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S2_HARMONIZED&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">lte</span><span class="p">(</span><span class="s2">&quot;CLOUDY_PIXEL_PERCENTAGE&quot;</span><span class="p">,</span> <span class="n">cloud_pct</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">ids</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">)</span>

    <span class="n">dw</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;GOOGLE/DYNAMICWORLD/V1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">inList</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">collection</span> <span class="o">=</span> <span class="n">dw</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>

    <span class="n">dwVisParams</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;#419BDF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#397D49&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#88B053&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#7A87C6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#E49635&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#DFC35A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#C4281B&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#A59B8F&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#B39FE1&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>

    <span class="n">images</span> <span class="o">=</span> <span class="n">create_timeseries</span><span class="p">(</span>
        <span class="n">collection</span><span class="p">,</span>
        <span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="p">,</span>
        <span class="n">region</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">,</span>
        <span class="n">reducer</span><span class="p">,</span>
        <span class="n">drop_empty</span><span class="p">,</span>
        <span class="n">date_format</span><span class="p">,</span>
        <span class="n">parallel_scale</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;class&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">images</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;visualize&quot;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">dwVisParams</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Create a Top-1 Probability Hillshade Visualization</span>
        <span class="n">probabilityBands</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;water&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;grass&quot;</span><span class="p">,</span>
            <span class="s2">&quot;flooded_vegetation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;crops&quot;</span><span class="p">,</span>
            <span class="s2">&quot;shrub_and_scrub&quot;</span><span class="p">,</span>
            <span class="s2">&quot;built&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bare&quot;</span><span class="p">,</span>
            <span class="s2">&quot;snow_and_ice&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="c1"># Select probability bands</span>
        <span class="n">probabilityCol</span> <span class="o">=</span> <span class="n">dw</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">probabilityBands</span><span class="p">)</span>

        <span class="n">prob_col</span> <span class="o">=</span> <span class="n">create_timeseries</span><span class="p">(</span>
            <span class="n">probabilityCol</span><span class="p">,</span>
            <span class="n">start_date</span><span class="p">,</span>
            <span class="n">end_date</span><span class="p">,</span>
            <span class="n">region</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">frequency</span><span class="p">,</span>
            <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
            <span class="n">drop_empty</span><span class="p">,</span>
            <span class="n">date_format</span><span class="p">,</span>
            <span class="n">parallel_scale</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">prob_images</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span>
            <span class="n">prob_col</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;probability&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_images</span>

        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;hillshade&quot;</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">prob_images</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

            <span class="k">def</span> <span class="nf">create_hillshade</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="n">proj</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">atScale</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                <span class="n">img</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">images</span><span class="o">.</span><span class="n">toList</span><span class="p">(</span><span class="n">images</span><span class="o">.</span><span class="n">size</span><span class="p">())</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
                <span class="n">prob_img</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">prob_images</span><span class="o">.</span><span class="n">toList</span><span class="p">(</span><span class="n">prob_images</span><span class="o">.</span><span class="n">size</span><span class="p">())</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
                <span class="n">prob_img</span> <span class="o">=</span> <span class="n">prob_img</span><span class="o">.</span><span class="n">setDefaultProjection</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
                <span class="n">top1Confidence</span> <span class="o">=</span> <span class="n">prob_img</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">int</span><span class="p">()</span>
                <span class="n">hillshade</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Terrain</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">top1Confidence</span><span class="p">)</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
                <span class="n">rgbImage</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">dwVisParams</span><span class="p">)</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
                <span class="n">probabilityHillshade</span> <span class="o">=</span> <span class="n">rgbImage</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">hillshade</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">probabilityHillshade</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">nums</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">create_hillshade</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.gif_fading" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gif_fading</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#geemap.timelapse.gif_fading" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fade in/out the gif.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input gif file. Can be a directory path or http URL, e.g., "https://i.imgur.com/ZWSZC5z.gif"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>duration</code></td>
        <td><code>float</code></td>
        <td><p>The duration of the fading. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>Raise exception when the input gif does not exist.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception when ffmpeg is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gif_fading</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fade in/out the gif.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input gif file. Can be a directory path or http URL, e.g., &quot;https://i.imgur.com/ZWSZC5z.gif&quot;</span>
<span class="sd">        out_gif (str): The output gif file.</span>
<span class="sd">        duration (float, optional): The duration of the fading. Defaults to 1.</span>
<span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: Raise exception when the input gif does not exist.</span>
<span class="sd">        Exception: Raise exception when ffmpeg is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>

    <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_gif</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span>
        <span class="n">download_from_url</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">in_gif</span> <span class="o">=</span> <span class="n">file_path</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;in_gif must be a gif file.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">in_gif</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The filename cannot contain spaces.&quot;</span><span class="p">)</span>

    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="n">basename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">):</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

    <span class="n">gif_to_png</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

    <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="s2">&quot;*.png&quot;</span><span class="p">)))</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-loop 1 -t </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> -i </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">[1:v][0:v]blend=all_expr=&#39;A*(if(gte(T,3),1,T/3))+B*(1-(if(gte(T,3),1,T/3)))&#39;[v0];&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:v][</span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">:v]blend=all_expr=&#39;A*(if(gte(T,3),1,T/3))+B*(1-(if(gte(T,3),1,T/3)))&#39;[v</span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">];&quot;</span>
            <span class="p">)</span>

    <span class="n">last_filter</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">last_filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">last_filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;concat=n=</span><span class="si">{</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">:v=1:a=0[v]&quot; -map &quot;[v]&quot;&#39;</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_filter</span><span class="p">)</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -y -loglevel error </span><span class="si">{</span><span class="n">inputs</span><span class="si">}</span><span class="s2"> -filter_complex </span><span class="si">{</span><span class="n">filters</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># if fade &gt;= duration:</span>
    <span class="c1">#     duration = fade + 1</span>

    <span class="c1"># files = []</span>
    <span class="c1"># for i in range(1, count + 1):</span>
    <span class="c1">#     files.append(f&quot;-framerate {framerate} -loop 1 -t {duration} -i {i}.png&quot;)</span>

    <span class="c1"># inputs = &quot; &quot;.join(files)</span>

    <span class="c1"># filters = []</span>
    <span class="c1"># for i in range(count):</span>
    <span class="c1">#     if i == 0:</span>
    <span class="c1">#         filters.append(f&#39;&quot;[0:v]fade=t=out:st=4:d={fade}[v0];&#39;)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         filters.append(</span>
    <span class="c1">#             f&quot;[{i}:v]fade=t=in:st=0:d={fade},fade=t=out:st=4:d={fade}[v{i}];&quot;</span>
    <span class="c1">#         )</span>

    <span class="c1"># last_filter = &quot;&quot;</span>
    <span class="c1"># for i in range(count):</span>
    <span class="c1">#     last_filter += f&quot;[v{i}]&quot;</span>
    <span class="c1"># last_filter += f&quot;concat=n={count}:v=1:a=0,split[v0][v1];&quot;</span>
    <span class="c1"># filters.append(last_filter)</span>
    <span class="c1"># palette = f&#39;[v0]palettegen[p];[v1][p]paletteuse[v]&quot; -map &quot;[v]&quot;&#39;</span>
    <span class="c1"># filters.append(palette)</span>
    <span class="c1"># filters = &quot; &quot;.join(filters)</span>

    <span class="c1"># cmd = f&quot;ffmpeg -y {inputs} -filter_complex {filters} {out_gif}&quot;</span>

    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">current_dir</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.gif_to_mp4" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span></code>


<a href="#geemap.timelapse.gif_to_mp4" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a gif to mp4.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_mp4</code></td>
        <td><code>str</code></td>
        <td><p>The output mp4 file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gif_to_mp4</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a gif to mp4.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input gif file.</span>
<span class="sd">        out_mp4 (str): The output mp4 file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">out_mp4</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.mp4&quot;</span><span class="p">):</span>
        <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_mp4</span> <span class="o">+</span> <span class="s2">&quot;.mp4&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tool</span><span class="p">(</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>

    <span class="k">if</span> <span class="n">width</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">height</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> -vcodec libx264 -crf 25 -pix_fmt yuv420p </span><span class="si">{</span><span class="n">out_mp4</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">+=</span> <span class="n">width</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="n">height</span> <span class="o">+=</span> <span class="n">height</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> -vf scale=</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> -vcodec libx264 -crf 25 -pix_fmt yuv420p </span><span class="si">{</span><span class="n">out_mp4</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create mp4 file.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.gif_to_png" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gif_to_png</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#geemap.timelapse.gif_to_png" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a gif to png.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>The prefix of the output png files. Defaults to None.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>Raise exception when the input gif does not exist.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception when ffmpeg is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gif_to_png</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a gif to png.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input gif file.</span>
<span class="sd">        out_dir (str, optional): The output directory. Defaults to None.</span>
<span class="sd">        prefix (str, optional): The prefix of the output png files. Defaults to None.</span>
<span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: Raise exception when the input gif does not exist.</span>
<span class="sd">        Exception: Raise exception when ffmpeg is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">in_gif</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;in_gif cannot contain spaces.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="n">basename</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;out_dir must be a string.&quot;</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> -vsync 0 </span><span class="si">{</span><span class="n">out_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">%d.png&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Images are saved to </span><span class="si">{</span><span class="n">out_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.goes_fire_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">goes_fire_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2020-09-05T15:00&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2020-09-06T02:00&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;GOES-17&#39;</span><span class="p">,</span> <span class="n">scan</span><span class="o">=</span><span class="s1">&#39;full_disk&#39;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">framesPerSecond</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;YYYY-MM-dd HH:mm&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;3%&#39;</span><span class="p">,</span> <span class="s1">&#39;3%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.goes_fire_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a timelapse of GOES fire data. The code is adapted from Justin Braaten's code: https://code.earthengine.google.com/8a083a7fb13b95ad4ba148ed9b65475e.
Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to save the gif.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the time series. Defaults to "2021-10-24T14:00:00".</p></td>
        <td><code>&#39;2020-09-05T15:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the time series. Defaults to "2021-10-25T01:00:00".</p></td>
        <td><code>&#39;2020-09-06T02:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>str</code></td>
        <td><p>The GOES satellite data to use. Defaults to "GOES-17".</p></td>
        <td><code>&#39;GOES-17&#39;</code></td>
      </tr>
      <tr>
        <td><code>scan</code></td>
        <td><code>str</code></td>
        <td><p>The GOES scan to use. Defaults to "full_disk".</p></td>
        <td><code>&#39;full_disk&#39;</code></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region of interest. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>The date format to use. Defaults to "YYYY-MM-dd HH:mm".</p></td>
        <td><code>&#39;YYYY-MM-dd HH:mm&#39;</code></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;3%&#39;, &#39;3%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;#ffffff&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use, e.g., "EPSG:3857". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;#000000&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the GIF to MP4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">goes_fire_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2020-09-05T15:00&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2020-09-06T02:00&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s2">&quot;GOES-17&quot;</span><span class="p">,</span>
    <span class="n">scan</span><span class="o">=</span><span class="s2">&quot;full_disk&quot;</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">framesPerSecond</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;YYYY-MM-dd HH:mm&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;3%&quot;</span><span class="p">,</span> <span class="s2">&quot;3%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a timelapse of GOES fire data. The code is adapted from Justin Braaten&#39;s code: https://code.earthengine.google.com/8a083a7fb13b95ad4ba148ed9b65475e.</span>
<span class="sd">    Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</span>

<span class="sd">    Args:</span>
<span class="sd">        out_gif (str): The file path to save the gif.</span>
<span class="sd">        start_date (str, optional): The start date of the time series. Defaults to &quot;2021-10-24T14:00:00&quot;.</span>
<span class="sd">        end_date (str, optional): The end date of the time series. Defaults to &quot;2021-10-25T01:00:00&quot;.</span>
<span class="sd">        data (str, optional): The GOES satellite data to use. Defaults to &quot;GOES-17&quot;.</span>
<span class="sd">        scan (str, optional): The GOES scan to use. Defaults to &quot;full_disk&quot;.</span>
<span class="sd">        region (ee.Geometry, optional): The region of interest. Defaults to None.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        date_format (str, optional): The date format to use. Defaults to &quot;YYYY-MM-dd HH:mm&quot;.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use, e.g., &quot;EPSG:3857&quot;. Defaults to None.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the GIF to MP4. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: Raise exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;region&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;goes_fire_</span><span class="si">{</span><span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">.gif&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">BBox</span><span class="p">(</span><span class="o">-</span><span class="mf">123.17</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">118.22</span><span class="p">,</span> <span class="mf">40.03</span><span class="p">)</span>

        <span class="n">col</span> <span class="o">=</span> <span class="n">goes_fire_timeseries</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
            <span class="p">)</span>

        <span class="c1"># visParams = {</span>
        <span class="c1">#     &quot;bands&quot;: [&quot;CMI_C02&quot;, &quot;CMI_GREEN&quot;, &quot;CMI_C01&quot;],</span>
        <span class="c1">#     &quot;min&quot;: 0,</span>
        <span class="c1">#     &quot;max&quot;: 0.8,</span>
        <span class="c1">#     &quot;dimensions&quot;: dimensions,</span>
        <span class="c1">#     &quot;framesPerSecond&quot;: framesPerSecond,</span>
        <span class="c1">#     &quot;region&quot;: region,</span>
        <span class="c1">#     &quot;crs&quot;: col.first().projection(),</span>
        <span class="c1"># }</span>

        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span>

        <span class="n">cmiFdcVisParams</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;dimensions&quot;</span><span class="p">:</span> <span class="n">dimensions</span><span class="p">,</span>
            <span class="s2">&quot;framesPerSecond&quot;</span><span class="p">:</span> <span class="n">framesPerSecond</span><span class="p">,</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">roi</span><span class="p">,</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">crs</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">image_dates</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>

        <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">cmiFdcVisParams</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">add_text_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">xy</span><span class="p">,</span>
                <span class="n">text_sequence</span><span class="p">,</span>
                <span class="n">font_type</span><span class="p">,</span>
                <span class="n">font_size</span><span class="p">,</span>
                <span class="n">font_color</span><span class="p">,</span>
                <span class="n">add_progress_bar</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">framesPerSecond</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
                <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
                <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">out_gif</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.goes_fire_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">goes_fire_timeseries</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2020-09-05T15:00&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2020-09-06T02:00&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;GOES-17&#39;</span><span class="p">,</span> <span class="n">scan</span><span class="o">=</span><span class="s1">&#39;full_disk&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#geemap.timelapse.goes_fire_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a time series of GOES Fire data. The code is adapted from Justin Braaten's code: https://code.earthengine.google.com/8a083a7fb13b95ad4ba148ed9b65475e.
Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the time series. Defaults to "2020-09-05T15:00".</p></td>
        <td><code>&#39;2020-09-05T15:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the time series. Defaults to "2020-09-06T02:00".</p></td>
        <td><code>&#39;2020-09-06T02:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>str</code></td>
        <td><p>The GOES satellite data to use. Defaults to "GOES-17".</p></td>
        <td><code>&#39;GOES-17&#39;</code></td>
      </tr>
      <tr>
        <td><code>scan</code></td>
        <td><code>str</code></td>
        <td><p>The GOES scan to use. Defaults to "full_disk".</p></td>
        <td><code>&#39;full_disk&#39;</code></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region of interest. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>merge</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to merge the fire timeseries with GOES CMI timeseries. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The data must be either GOES-16 or GOES-17.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The scan must be either full_disk or conus.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>GOES fire timeseries.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">goes_fire_timeseries</span><span class="p">(</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2020-09-05T15:00&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2020-09-06T02:00&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s2">&quot;GOES-17&quot;</span><span class="p">,</span>
    <span class="n">scan</span><span class="o">=</span><span class="s2">&quot;full_disk&quot;</span><span class="p">,</span>
    <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a time series of GOES Fire data. The code is adapted from Justin Braaten&#39;s code: https://code.earthengine.google.com/8a083a7fb13b95ad4ba148ed9b65475e.</span>
<span class="sd">    Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</span>

<span class="sd">    Args:</span>
<span class="sd">        start_date (str, optional): The start date of the time series. Defaults to &quot;2020-09-05T15:00&quot;.</span>
<span class="sd">        end_date (str, optional): The end date of the time series. Defaults to &quot;2020-09-06T02:00&quot;.</span>
<span class="sd">        data (str, optional): The GOES satellite data to use. Defaults to &quot;GOES-17&quot;.</span>
<span class="sd">        scan (str, optional): The GOES scan to use. Defaults to &quot;full_disk&quot;.</span>
<span class="sd">        region (ee.Geometry, optional): The region of interest. Defaults to None.</span>
<span class="sd">        merge (bool, optional): Whether to merge the fire timeseries with GOES CMI timeseries. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The data must be either GOES-16 or GOES-17.</span>
<span class="sd">        ValueError: The scan must be either full_disk or conus.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: GOES fire timeseries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;GOES-16&quot;</span><span class="p">,</span> <span class="s2">&quot;GOES-17&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The data must be either GOES-16 or GOES-17.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">scan</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;full_disk&quot;</span><span class="p">,</span> <span class="s2">&quot;conus&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The scan must be either full_disk or conus.&quot;</span><span class="p">)</span>

    <span class="n">scan_types</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;full_disk&quot;</span><span class="p">:</span> <span class="s2">&quot;FDCF&quot;</span><span class="p">,</span>
        <span class="s2">&quot;conus&quot;</span><span class="p">:</span> <span class="s2">&quot;FDCC&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">BBox</span><span class="p">(</span><span class="o">-</span><span class="mf">123.17</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">118.22</span><span class="p">,</span> <span class="mf">40.03</span><span class="p">)</span>

    <span class="c1"># Get the fire/hotspot characterization dataset.</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NOAA/GOES/</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">scan_types</span><span class="p">[</span><span class="n">scan</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fdcCol</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="c1"># Identify fire-detected pixels of medium to high confidence.</span>
    <span class="n">fireMaskCodes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">]</span>
    <span class="n">confVals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
    <span class="n">defaultConfVal</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">fdcVis</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">confImg</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">remap</span><span class="p">(</span><span class="n">fireMaskCodes</span><span class="p">,</span> <span class="n">confVals</span><span class="p">,</span> <span class="n">defaultConfVal</span><span class="p">,</span> <span class="s2">&quot;Mask&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">confImg</span><span class="o">.</span><span class="n">gte</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
            <span class="o">.</span><span class="n">selfMask</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="n">fdcVisCol</span> <span class="o">=</span> <span class="n">fdcCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">fdcVis</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">merge</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fdcVisCol</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">geosVisCol</span> <span class="o">=</span> <span class="n">goes_timeseries</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
        <span class="c1"># Join the fire collection to the CMI collection.</span>
        <span class="n">joinFilter</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span><span class="s2">&quot;leftField&quot;</span><span class="p">:</span> <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="s2">&quot;rightField&quot;</span><span class="p">:</span> <span class="s2">&quot;system:time_start&quot;</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">joinedCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Join</span><span class="o">.</span><span class="n">saveFirst</span><span class="p">(</span><span class="s2">&quot;match&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">geosVisCol</span><span class="p">,</span> <span class="n">fdcVisCol</span><span class="p">,</span> <span class="n">joinFilter</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">overlayVis</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
            <span class="n">cmi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span>
                <span class="o">**</span><span class="p">{</span>
                    <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CMI_C02&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_GREEN&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C01&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                    <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">fdc</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;match&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span>
                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ff5349&quot;</span><span class="p">],</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">cmi</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="n">fdc</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">))</span>

        <span class="n">cmiFdcVisCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">joinedCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">overlayVis</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cmiFdcVisCol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.goes_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">goes_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2021-10-24T14:00:00&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2021-10-25T01:00:00&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;GOES-17&#39;</span><span class="p">,</span> <span class="n">scan</span><span class="o">=</span><span class="s1">&#39;full_disk&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CMI_C02&#39;</span><span class="p">,</span> <span class="s1">&#39;CMI_GREEN&#39;</span><span class="p">,</span> <span class="s1">&#39;CMI_C01&#39;</span><span class="p">],</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">framesPerSecond</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;YYYY-MM-dd HH:mm&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;3%&#39;</span><span class="p">,</span> <span class="s1">&#39;3%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.goes_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a timelapse of GOES data. The code is adapted from Justin Braaten's code: https://code.earthengine.google.com/57245f2d3d04233765c42fb5ef19c1f4.
Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region of interest. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to save the gif.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the time series. Defaults to "2021-10-24T14:00:00".</p></td>
        <td><code>&#39;2021-10-24T14:00:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the time series. Defaults to "2021-10-25T01:00:00".</p></td>
        <td><code>&#39;2021-10-25T01:00:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>str</code></td>
        <td><p>The GOES satellite data to use. Defaults to "GOES-17".</p></td>
        <td><code>&#39;GOES-17&#39;</code></td>
      </tr>
      <tr>
        <td><code>scan</code></td>
        <td><code>str</code></td>
        <td><p>The GOES scan to use. Defaults to "full_disk".</p></td>
        <td><code>&#39;full_disk&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to visualize. Defaults to ["CMI_C02", "CMI_GREEN", "CMI_C01"].</p></td>
        <td><code>[&#39;CMI_C02&#39;, &#39;CMI_GREEN&#39;, &#39;CMI_C01&#39;]</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>The date format to use. Defaults to "YYYY-MM-dd HH:mm".</p></td>
        <td><code>&#39;YYYY-MM-dd HH:mm&#39;</code></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;3%&#39;, &#39;3%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;#ffffff&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use, e.g., "EPSG:3857". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Line width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to save the animation as an mp4 file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">goes_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2021-10-24T14:00:00&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2021-10-25T01:00:00&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s2">&quot;GOES-17&quot;</span><span class="p">,</span>
    <span class="n">scan</span><span class="o">=</span><span class="s2">&quot;full_disk&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CMI_C02&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_GREEN&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C01&quot;</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">framesPerSecond</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;YYYY-MM-dd HH:mm&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;3%&quot;</span><span class="p">,</span> <span class="s2">&quot;3%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a timelapse of GOES data. The code is adapted from Justin Braaten&#39;s code: https://code.earthengine.google.com/57245f2d3d04233765c42fb5ef19c1f4.</span>
<span class="sd">    Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (ee.Geometry, optional): The region of interest. Defaults to None.</span>
<span class="sd">        out_gif (str): The file path to save the gif.</span>
<span class="sd">        start_date (str, optional): The start date of the time series. Defaults to &quot;2021-10-24T14:00:00&quot;.</span>
<span class="sd">        end_date (str, optional): The end date of the time series. Defaults to &quot;2021-10-25T01:00:00&quot;.</span>
<span class="sd">        data (str, optional): The GOES satellite data to use. Defaults to &quot;GOES-17&quot;.</span>
<span class="sd">        scan (str, optional): The GOES scan to use. Defaults to &quot;full_disk&quot;.</span>
<span class="sd">        bands (list, optional): The bands to visualize. Defaults to [&quot;CMI_C02&quot;, &quot;CMI_GREEN&quot;, &quot;CMI_C01&quot;].</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        date_format (str, optional): The date format to use. Defaults to &quot;YYYY-MM-dd HH:mm&quot;.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use, e.g., &quot;EPSG:3857&quot;. Defaults to None.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Line width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        mp4 (bool, optional): Whether to save the animation as an mp4 file. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>
<span class="sd">    Raises:</span>
<span class="sd">        Exception: Raise exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;region&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;goes_</span><span class="si">{</span><span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">.gif&quot;</span><span class="p">)</span>

        <span class="n">visParams</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">bands</span><span class="p">,</span>
            <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">goes_timeseries</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">visParams</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">159.5954</span><span class="p">,</span> <span class="mf">60.4088</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">159.5954</span><span class="p">,</span> <span class="mf">24.5178</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">114.2438</span><span class="p">,</span> <span class="mf">24.5178</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">114.2438</span><span class="p">,</span> <span class="mf">60.4088</span><span class="p">],</span>
                    <span class="p">]</span>
                <span class="p">],</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span>

        <span class="n">videoParams</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">],</span>
            <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
            <span class="s2">&quot;dimensions&quot;</span><span class="p">:</span> <span class="n">dimensions</span><span class="p">,</span>
            <span class="s2">&quot;framesPerSecond&quot;</span><span class="p">:</span> <span class="n">framesPerSecond</span><span class="p">,</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">roi</span><span class="p">,</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">crs</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">image_dates</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>

        <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">videoParams</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">add_text_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">xy</span><span class="p">,</span>
                <span class="n">text_sequence</span><span class="p">,</span>
                <span class="n">font_type</span><span class="p">,</span>
                <span class="n">font_size</span><span class="p">,</span>
                <span class="n">font_color</span><span class="p">,</span>
                <span class="n">add_progress_bar</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">framesPerSecond</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
                <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
                <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">out_gif</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.goes_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">goes_timeseries</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2021-10-24T14:00:00&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2021-10-25T01:00:00&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;GOES-17&#39;</span><span class="p">,</span> <span class="n">scan</span><span class="o">=</span><span class="s1">&#39;full_disk&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_night</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;a_mode&#39;</span><span class="p">])</span></code>


<a href="#geemap.timelapse.goes_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a time series of GOES data. The code is adapted from Justin Braaten's code: https://code.earthengine.google.com/57245f2d3d04233765c42fb5ef19c1f4.
Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the time series. Defaults to "2021-10-24T14:00:00".</p></td>
        <td><code>&#39;2021-10-24T14:00:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the time series. Defaults to "2021-10-25T01:00:00".</p></td>
        <td><code>&#39;2021-10-25T01:00:00&#39;</code></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>str</code></td>
        <td><p>The GOES satellite data to use. Defaults to "GOES-17".</p></td>
        <td><code>&#39;GOES-17&#39;</code></td>
      </tr>
      <tr>
        <td><code>scan</code></td>
        <td><code>str</code></td>
        <td><p>The GOES scan to use. Defaults to "full_disk".</p></td>
        <td><code>&#39;full_disk&#39;</code></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region of interest. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>show_night</code></td>
        <td><code>list</code></td>
        <td><p>Show the clouds at night through [True, "a_mode"] o [True, "b_mode"].  Defaults to [False, "a_mode"]</p></td>
        <td><code>[False, &#39;a_mode&#39;]</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The data must be either GOES-16 or GOES-17.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The scan must be either full_disk, conus, or mesoscale.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>GOES timeseries.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">goes_timeseries</span><span class="p">(</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2021-10-24T14:00:00&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2021-10-25T01:00:00&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s2">&quot;GOES-17&quot;</span><span class="p">,</span>
    <span class="n">scan</span><span class="o">=</span><span class="s2">&quot;full_disk&quot;</span><span class="p">,</span>
    <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show_night</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;a_mode&quot;</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a time series of GOES data. The code is adapted from Justin Braaten&#39;s code: https://code.earthengine.google.com/57245f2d3d04233765c42fb5ef19c1f4.</span>
<span class="sd">    Credits to Justin Braaten. See also https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16</span>

<span class="sd">    Args:</span>
<span class="sd">        start_date (str, optional): The start date of the time series. Defaults to &quot;2021-10-24T14:00:00&quot;.</span>
<span class="sd">        end_date (str, optional): The end date of the time series. Defaults to &quot;2021-10-25T01:00:00&quot;.</span>
<span class="sd">        data (str, optional): The GOES satellite data to use. Defaults to &quot;GOES-17&quot;.</span>
<span class="sd">        scan (str, optional): The GOES scan to use. Defaults to &quot;full_disk&quot;.</span>
<span class="sd">        region (ee.Geometry, optional): The region of interest. Defaults to None.</span>
<span class="sd">        show_night (list, optional): Show the clouds at night through [True, &quot;a_mode&quot;] o [True, &quot;b_mode&quot;].  Defaults to [False, &quot;a_mode&quot;]</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The data must be either GOES-16 or GOES-17.</span>
<span class="sd">        ValueError: The scan must be either full_disk, conus, or mesoscale.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: GOES timeseries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;GOES-16&quot;</span><span class="p">,</span> <span class="s2">&quot;GOES-17&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The data must be either GOES-16 or GOES-17.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">scan</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;full_disk&quot;</span><span class="p">,</span> <span class="s2">&quot;conus&quot;</span><span class="p">,</span> <span class="s2">&quot;mesoscale&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The scan must be either full_disk, conus, or mesoscale.&quot;</span><span class="p">)</span>

    <span class="n">scan_types</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;full_disk&quot;</span><span class="p">:</span> <span class="s2">&quot;MCMIPF&quot;</span><span class="p">,</span>
        <span class="s2">&quot;conus&quot;</span><span class="p">:</span> <span class="s2">&quot;MCMIPC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mesoscale&quot;</span><span class="p">:</span> <span class="s2">&quot;MCMIPM&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NOAA/GOES/</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">scan_types</span><span class="p">[</span><span class="n">scan</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">159.5954379282731</span><span class="p">,</span> <span class="mf">60.40883060191719</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">159.5954379282731</span><span class="p">,</span> <span class="mf">24.517881970830725</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.2438754282731</span><span class="p">,</span> <span class="mf">24.517881970830725</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.2438754282731</span><span class="p">,</span> <span class="mf">60.40883060191719</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Applies scaling factors.</span>
    <span class="k">def</span> <span class="nf">applyScaleAndOffset</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">getFactorImg</span><span class="p">(</span><span class="n">factorNames</span><span class="p">):</span>
            <span class="n">factorList</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">toDictionary</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">factorNames</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">factorList</span><span class="p">)</span>

        <span class="n">scaleImg</span> <span class="o">=</span> <span class="n">getFactorImg</span><span class="p">([</span><span class="s2">&quot;CMI_C.._scale&quot;</span><span class="p">])</span>
        <span class="n">offsetImg</span> <span class="o">=</span> <span class="n">getFactorImg</span><span class="p">([</span><span class="s2">&quot;CMI_C.._offset&quot;</span><span class="p">])</span>
        <span class="n">scaled</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C..&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">scaleImg</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">offsetImg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;srcImg&quot;</span><span class="p">:</span> <span class="n">scaled</span><span class="p">,</span> <span class="s2">&quot;overwrite&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="c1"># Adds a synthetic green band.</span>
    <span class="k">def</span> <span class="nf">addGreenBand</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span>
            <span class="s2">&quot;CMI_GREEN = 0.45 * red + 0.10 * nir + 0.45 * blue&quot;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;blue&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C01&quot;</span><span class="p">),</span>
                <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C02&quot;</span><span class="p">),</span>
                <span class="s2">&quot;nir&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C03&quot;</span><span class="p">),</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">green</span><span class="p">)</span>

    <span class="c1"># Show at clouds at night (a-mode)</span>
    <span class="k">def</span> <span class="nf">showNighta</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="c1"># Make normalized infrared</span>
        <span class="n">IR_n</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C13&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unitScale</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
        <span class="n">IR_n</span> <span class="o">=</span> <span class="n">IR_n</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span>
            <span class="s2">&quot;ir_p = (1 -IR_n)/1.4&quot;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;IR_n&quot;</span><span class="p">:</span> <span class="n">IR_n</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C13&quot;</span><span class="p">),</span>
            <span class="p">},</span>
        <span class="p">)</span>

        <span class="c1"># Add infrared to rgb bands</span>
        <span class="n">R_ir</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C02&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">IR_n</span><span class="p">)</span>
        <span class="n">G_ir</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_GREEN&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">IR_n</span><span class="p">)</span>
        <span class="n">B_ir</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">IR_n</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">([</span><span class="n">R_ir</span><span class="p">,</span> <span class="n">G_ir</span><span class="p">,</span> <span class="n">B_ir</span><span class="p">],</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Show at clouds at night (b-mode)</span>
    <span class="k">def</span> <span class="nf">showNightb</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">night</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C03&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unitScale</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">)</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">cmi11</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C11&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unitScale</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">310</span><span class="p">)</span>
        <span class="n">cmi13</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C13&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unitScale</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">cmi15</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;CMI_C15&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unitScale</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">310</span><span class="p">)</span>
        <span class="n">iNight</span> <span class="o">=</span> <span class="n">cmi15</span><span class="o">.</span><span class="n">addBands</span><span class="p">([</span><span class="n">cmi13</span><span class="p">,</span> <span class="n">cmi11</span><span class="p">])</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">iRGBNight</span> <span class="o">=</span> <span class="n">iNight</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">})</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span>
            <span class="n">night</span>
        <span class="p">)</span>

        <span class="n">iRGB</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CMI_C02&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C03&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C01&quot;</span><span class="p">],</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">iRGB</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="n">iRGBNight</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Scales select bands for visualization.</span>
    <span class="k">def</span> <span class="nf">scaleForVis</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;CMI_C01&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_GREEN&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C02&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C03&quot;</span><span class="p">,</span> <span class="s2">&quot;CMI_C05&quot;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;bicubic&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">log10</span><span class="p">()</span>
            <span class="o">.</span><span class="n">interpolate</span><span class="p">([</span><span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.176</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;clamp&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unmask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="c1"># Wraps previous functions.</span>
    <span class="k">def</span> <span class="nf">processForVis</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">show_night</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">show_night</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a_mode&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">scaleForVis</span><span class="p">(</span><span class="n">showNighta</span><span class="p">(</span><span class="n">addGreenBand</span><span class="p">(</span><span class="n">applyScaleAndOffset</span><span class="p">(</span><span class="n">img</span><span class="p">))))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">showNightb</span><span class="p">(</span><span class="n">applyScaleAndOffset</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scaleForVis</span><span class="p">(</span><span class="n">addGreenBand</span><span class="p">(</span><span class="n">applyScaleAndOffset</span><span class="p">(</span><span class="n">img</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">col</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">processForVis</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.landsat_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">landsat_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;06-10&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;09-20&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NIR&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nd_bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nd_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nd_palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.landsat_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a Landsat timelapse GIF image. This function is adapted from https://emaprlab.users.earthengine.app/view/lt-gee-time-series-animator. A huge thank you to Justin Braaten for sharing his fantastic work.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output animated GIF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 1984.</p></td>
        <td><code>1984</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which will use the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '06-10'.</p></td>
        <td><code>&#39;06-10&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '09-20'.</p></td>
        <td><code>&#39;09-20&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>Three bands selected from ['Blue', 'Green', 'Red', 'NIR', 'SWIR1', 'SWIR2', 'pixel_qa']. Defaults to ['NIR', 'Red', 'Green'].</p></td>
        <td><code>[&#39;NIR&#39;, &#39;Red&#39;, &#39;Green&#39;]</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>Visualization parameters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>apply_fmask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>nd_bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of names specifying the bands to use, e.g., ['Green', 'SWIR1']. The normalized difference is computed as (first  second) / (first + second). Note that negative input values are forced to 0 so that the result is confined to the range (-1, 1).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nd_threshold</code></td>
        <td><code>float</code></td>
        <td><p>The threshold for extracting pixels from the normalized difference band.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>nd_palette</code></td>
        <td><code>list</code></td>
        <td><p>The color palette to use for displaying the normalized difference band.</p></td>
        <td><code>[&#39;black&#39;, &#39;blue&#39;]</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Line width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Date format for the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the GIF to MP4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>Step size for the timelapse. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the output GIF image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">landsat_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;06-10&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;09-20&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">],</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">nd_bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nd_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">nd_palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">],</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a Landsat timelapse GIF image. This function is adapted from https://emaprlab.users.earthengine.app/view/lt-gee-time-series-animator. A huge thank you to Justin Braaten for sharing his fantastic work.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        out_gif (str, optional): File path to the output animated GIF. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 1984.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which will use the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;06-10&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;09-20&#39;.</span>
<span class="sd">        bands (list, optional): Three bands selected from [&#39;Blue&#39;, &#39;Green&#39;, &#39;Red&#39;, &#39;NIR&#39;, &#39;SWIR1&#39;, &#39;SWIR2&#39;, &#39;pixel_qa&#39;]. Defaults to [&#39;NIR&#39;, &#39;Red&#39;, &#39;Green&#39;].</span>
<span class="sd">        vis_params (dict, optional): Visualization parameters. Defaults to None.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 5.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        apply_fmask (bool, optional): Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</span>
<span class="sd">        nd_bands (list, optional): A list of names specifying the bands to use, e.g., [&#39;Green&#39;, &#39;SWIR1&#39;]. The normalized difference is computed as (first  second) / (first + second). Note that negative input values are forced to 0 so that the result is confined to the range (-1, 1).</span>
<span class="sd">        nd_threshold (float, optional): The threshold for extracting pixels from the normalized difference band.</span>
<span class="sd">        nd_palette (list, optional): The color palette to use for displaying the normalized difference band.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Line width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        date_format (str, optional): Date format for the timelapse. Defaults to None.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the GIF to MP4. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>
<span class="sd">        step (int, optional): Step size for the timelapse. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the output GIF image.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Feature</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided roi is invalid. It must be an ee.Geometry&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The output file must end with .gif&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">get_current_year</span><span class="p">()</span>

    <span class="n">allowed_bands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">allowed_bands</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;You can only select 3 bands from the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_bands</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">nd_bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd_bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">allowed_bands</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nd_bands</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;You can only select two bands from the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_bands</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">raw_col</span> <span class="o">=</span> <span class="n">landsat_timeseries</span><span class="p">(</span>
            <span class="n">roi</span><span class="p">,</span>
            <span class="n">start_year</span><span class="p">,</span>
            <span class="n">end_year</span><span class="p">,</span>
            <span class="n">start_date</span><span class="p">,</span>
            <span class="n">end_date</span><span class="p">,</span>
            <span class="n">apply_fmask</span><span class="p">,</span>
            <span class="n">frequency</span><span class="p">,</span>
            <span class="n">date_format</span><span class="p">,</span>
            <span class="n">step</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">col</span> <span class="o">=</span> <span class="n">raw_col</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">vis_params</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">dimensions</span> <span class="o">&gt;</span> <span class="mi">768</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">dim</span> <span class="o">&gt;</span> <span class="mi">768</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))))</span>
        <span class="p">):</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">out_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))))</span><span class="si">}</span><span class="s2">.jpg&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">get_image_collection_thumbnails</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span>
                <span class="n">out_dir</span><span class="p">,</span>
                <span class="n">vis_params</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                    <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">],</span>
                <span class="p">},</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">make_gif</span><span class="p">(</span>
                <span class="n">names</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">fps</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">clean_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">video_args</span> <span class="o">=</span> <span class="n">vis_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dimensions</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roi</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;framesPerSecond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frames_per_second</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">]</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>

            <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">video_args</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">add_text_to_gif</span><span class="p">(</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="n">title_xy</span><span class="p">,</span>
                    <span class="n">text_sequence</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                    <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                    <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                    <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                    <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
                <span class="n">add_text_to_gif</span><span class="p">(</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span>
                    <span class="n">text_sequence</span><span class="o">=</span><span class="n">text_sequence</span><span class="p">,</span>
                    <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                    <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                    <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                    <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                    <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">nd_bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nd_images</span> <span class="o">=</span> <span class="n">landsat_ts_norm_diff</span><span class="p">(</span>
                <span class="n">raw_col</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="n">nd_bands</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">nd_threshold</span>
            <span class="p">)</span>
            <span class="n">out_nd_gif</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;_nd.gif&quot;</span><span class="p">)</span>
            <span class="n">landsat_ts_norm_diff_gif</span><span class="p">(</span>
                <span class="n">nd_images</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="o">=</span><span class="n">out_nd_gif</span><span class="p">,</span>
                <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">nd_palette</span><span class="p">,</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">frames_per_second</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_gif</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.landsat_timelapse_legacy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">landsat_timelapse_legacy</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;06-10&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;09-20&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NIR&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nd_bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nd_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nd_palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.timelapse.landsat_timelapse_legacy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a Landsat timelapse GIF image. This function is adapted from https://emaprlab.users.earthengine.app/view/lt-gee-time-series-animator. A huge thank you to Justin Braaten for sharing his fantastic work.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output animated GIF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 1984.</p></td>
        <td><code>1984</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which means the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '06-10'.</p></td>
        <td><code>&#39;06-10&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '09-20'.</p></td>
        <td><code>&#39;09-20&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>Three bands selected from ['Blue', 'Green', 'Red', 'NIR', 'SWIR1', 'SWIR2', 'pixel_qa']. Defaults to ['NIR', 'Red', 'Green'].</p></td>
        <td><code>[&#39;NIR&#39;, &#39;Red&#39;, &#39;Green&#39;]</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>Visualization parameters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>apply_fmask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>nd_bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of names specifying the bands to use, e.g., ['Green', 'SWIR1']. The normalized difference is computed as (first  second) / (first + second). Note that negative input values are forced to 0 so that the result is confined to the range (-1, 1).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nd_threshold</code></td>
        <td><code>float</code></td>
        <td><p>The threshold for extracting pixels from the normalized difference band.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>nd_palette</code></td>
        <td><code>list</code></td>
        <td><p>The color palette to use for displaying the normalized difference band.</p></td>
        <td><code>[&#39;black&#39;, &#39;blue&#39;]</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Line width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Date format for the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the GIF to MP4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the output GIF image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">landsat_timelapse_legacy</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;06-10&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;09-20&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">],</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">nd_bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nd_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">nd_palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">],</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a Landsat timelapse GIF image. This function is adapted from https://emaprlab.users.earthengine.app/view/lt-gee-time-series-animator. A huge thank you to Justin Braaten for sharing his fantastic work.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        out_gif (str, optional): File path to the output animated GIF. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 1984.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which means the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;06-10&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;09-20&#39;.</span>
<span class="sd">        bands (list, optional): Three bands selected from [&#39;Blue&#39;, &#39;Green&#39;, &#39;Red&#39;, &#39;NIR&#39;, &#39;SWIR1&#39;, &#39;SWIR2&#39;, &#39;pixel_qa&#39;]. Defaults to [&#39;NIR&#39;, &#39;Red&#39;, &#39;Green&#39;].</span>
<span class="sd">        vis_params (dict, optional): Visualization parameters. Defaults to None.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 5.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        apply_fmask (bool, optional): Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</span>
<span class="sd">        nd_bands (list, optional): A list of names specifying the bands to use, e.g., [&#39;Green&#39;, &#39;SWIR1&#39;]. The normalized difference is computed as (first  second) / (first + second). Note that negative input values are forced to 0 so that the result is confined to the range (-1, 1).</span>
<span class="sd">        nd_threshold (float, optional): The threshold for extracting pixels from the normalized difference band.</span>
<span class="sd">        nd_palette (list, optional): The color palette to use for displaying the normalized difference band.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Line width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        date_format (str, optional): Date format for the timelapse. Defaults to None.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the GIF to MP4. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the output GIF image.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">get_current_year</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Feature</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided roi is invalid. It must be an ee.Geometry&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The output file must end with .gif&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">allowed_bands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">allowed_bands</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;You can only select 3 bands from the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_bands</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">nd_bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd_bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">allowed_bands</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nd_bands</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;You can only select two bands from the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_bands</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4000</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">raw_col</span> <span class="o">=</span> <span class="n">landsat_timeseries</span><span class="p">(</span>
            <span class="n">roi</span><span class="p">,</span>
            <span class="n">start_year</span><span class="p">,</span>
            <span class="n">end_year</span><span class="p">,</span>
            <span class="n">start_date</span><span class="p">,</span>
            <span class="n">end_date</span><span class="p">,</span>
            <span class="n">apply_fmask</span><span class="p">,</span>
            <span class="n">frequency</span><span class="p">,</span>
            <span class="n">date_format</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">col</span> <span class="o">=</span> <span class="n">raw_col</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">vis_params</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">dimensions</span> <span class="o">&gt;</span> <span class="mi">768</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">dim</span> <span class="o">&gt;</span> <span class="mi">768</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))))</span>
        <span class="p">):</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">out_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))))</span><span class="si">}</span><span class="s2">.jpg&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">get_image_collection_thumbnails</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span>
                <span class="n">out_dir</span><span class="p">,</span>
                <span class="n">vis_params</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                    <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">],</span>
                <span class="p">},</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">make_gif</span><span class="p">(</span>
                <span class="n">names</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">fps</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">clean_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">video_args</span> <span class="o">=</span> <span class="n">vis_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dimensions</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roi</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;framesPerSecond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frames_per_second</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">]</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>

            <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">video_args</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">add_text_to_gif</span><span class="p">(</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="n">title_xy</span><span class="p">,</span>
                    <span class="n">text_sequence</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                    <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                    <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                    <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                    <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
                <span class="n">add_text_to_gif</span><span class="p">(</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span>
                    <span class="n">text_sequence</span><span class="o">=</span><span class="n">text_sequence</span><span class="p">,</span>
                    <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                    <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                    <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                    <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                    <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">nd_bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nd_images</span> <span class="o">=</span> <span class="n">landsat_ts_norm_diff</span><span class="p">(</span>
                <span class="n">raw_col</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="n">nd_bands</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">nd_threshold</span>
            <span class="p">)</span>
            <span class="n">out_nd_gif</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;_nd.gif&quot;</span><span class="p">)</span>
            <span class="n">landsat_ts_norm_diff_gif</span><span class="p">(</span>
                <span class="n">nd_images</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="o">=</span><span class="n">out_nd_gif</span><span class="p">,</span>
                <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="n">nd_palette</span><span class="p">,</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">frames_per_second</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_gif</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.landsat_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">landsat_timeseries</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;06-10&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;09-20&#39;</span><span class="p">,</span> <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.landsat_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates an annual Landsat ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 1984.</p></td>
        <td><code>1984</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which means the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '06-10'.</p></td>
        <td><code>&#39;06-10&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '09-20'.</p></td>
        <td><code>&#39;09-20&#39;</code></td>
      </tr>
      <tr>
        <td><code>apply_fmask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Format of the date. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step size to use when creating the date sequence. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns an ImageCollection containing annual Landsat images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">landsat_timeseries</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;06-10&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;09-20&quot;</span><span class="p">,</span>
    <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an annual Landsat ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 1984.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which means the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;06-10&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;09-20&#39;.</span>
<span class="sd">        apply_fmask (bool, optional): Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        date_format (str, optional): Format of the date. Defaults to None.</span>
<span class="sd">        step (int, optional): The step size to use when creating the date sequence. Defaults to 1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        object: Returns an ImageCollection containing annual Landsat images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Input and output parameters.</span>
    <span class="kn">import</span> <span class="nn">re</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">get_current_year</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not convert the provided roi to ee.Geometry&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="n">feq_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quarter&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">date_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date_format</span> <span class="o">=</span> <span class="n">feq_dict</span><span class="p">[</span><span class="n">frequency</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">feq_dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;frequency must be year, quarter, or month.&quot;</span><span class="p">)</span>

    <span class="c1"># Setup vars to get dates.</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">start_year</span> <span class="o">&gt;=</span> <span class="mi">1984</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">start_year</span> <span class="o">&lt;</span> <span class="n">get_current_year</span><span class="p">())</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The start year must be an integer &gt;= 1984.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">end_year</span> <span class="o">&gt;</span> <span class="mi">1984</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">end_year</span> <span class="o">&lt;=</span> <span class="n">get_current_year</span><span class="p">())</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The end year must be an integer &lt;= </span><span class="si">{</span><span class="n">get_current_year</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[0-9]</span><span class="si">{2}</span><span class="s2">-[0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;[0-9]</span><span class="si">{2}</span><span class="s2">-[0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end_date</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The start date and end date must be month-day, such as 06-10, 09-20&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">end_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input dates are invalid.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">days_between</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">d2</span> <span class="o">-</span> <span class="n">d1</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>

    <span class="n">n_days</span> <span class="o">=</span> <span class="n">days_between</span><span class="p">(</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">start_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">end_date</span>
    <span class="p">)</span>
    <span class="n">start_month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>

    <span class="c1"># Landsat collection preprocessingEnabled</span>
    <span class="c1"># Get Landsat surface reflectance collections for OLI, ETM+ and TM sensors.</span>
    <span class="n">LC09col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC09/C02/T1_L2&quot;</span><span class="p">)</span>
    <span class="n">LC08col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C02/T1_L2&quot;</span><span class="p">)</span>
    <span class="n">LE07col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LE07/C02/T1_L2&quot;</span><span class="p">)</span>
    <span class="n">LT05col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LT05/C02/T1_L2&quot;</span><span class="p">)</span>
    <span class="n">LT04col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LT04/C02/T1_L2&quot;</span><span class="p">)</span>

    <span class="c1"># Define a collection filter by date, bounds, and quality.</span>
    <span class="k">def</span> <span class="nf">colFilter</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">col</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="c1"># Function to get and rename bands of interest from OLI.</span>
    <span class="k">def</span> <span class="nf">renameOli</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;SR_B2&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B6&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B7&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># Function to get and rename bands of interest from ETM+.</span>
    <span class="k">def</span> <span class="nf">renameEtm</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;SR_B1&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B2&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B7&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">fmask</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
        <span class="c1"># see https://developers.google.com/earth-engine/datasets/catalog/LANDSAT_LC09_C02_T1_L2</span>
        <span class="c1"># Bit 0 - Fill</span>
        <span class="c1"># Bit 1 - Dilated Cloud</span>
        <span class="c1"># Bit 2 - Cirrus</span>
        <span class="c1"># Bit 3 - Cloud</span>
        <span class="c1"># Bit 4 - Cloud Shadow</span>
        <span class="n">qaMask</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA_PIXEL&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;11111&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Apply the scaling factors to the appropriate bands.</span>
        <span class="n">opticalBands</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SR_B.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.0000275</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># Replace the original bands with the scaled ones and apply the masks.</span>
        <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">opticalBands</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">qaMask</span><span class="p">)</span>

    <span class="c1"># Define function to prepare OLI images.</span>
    <span class="k">def</span> <span class="nf">prepOli</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">img</span>
        <span class="k">if</span> <span class="n">apply_fmask</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SR_B.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.0000275</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">renameOli</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">copyProperties</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">orig</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
            <span class="s2">&quot;bicubic&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Define function to prepare ETM+ images.</span>
    <span class="k">def</span> <span class="nf">prepEtm</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">img</span>
        <span class="k">if</span> <span class="n">apply_fmask</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SR_B.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.0000275</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">renameEtm</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">copyProperties</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">orig</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
            <span class="s2">&quot;bicubic&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get annual median collection.</span>
    <span class="k">def</span> <span class="nf">getAnnualComp</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">fromYMD</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">start_month</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">start_day</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">n_days</span><span class="p">),</span> <span class="s2">&quot;day&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">LC09coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC09col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LC08coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC08col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LE07coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LE07col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT05coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT05col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT04coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT04col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">LC09coly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LC08coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LE07coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT05coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT04coly</span><span class="p">)</span>

        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">yearImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">yearImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">yearImg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Get monthly median collection.</span>
    <span class="k">def</span> <span class="nf">getMonthlyComp</span><span class="p">(</span><span class="n">startDate</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">LC09coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC09col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LC08coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC08col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LE07coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LE07col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT05coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT05col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT04coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT04col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">LC09coly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LC08coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LE07coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT05coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT04coly</span><span class="p">)</span>

        <span class="n">monthImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">monthImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">monthImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">monthImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">monthImg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Get quarterly median collection.</span>
    <span class="k">def</span> <span class="nf">getQuarterlyComp</span><span class="p">(</span><span class="n">startDate</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span>

        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">LC09coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC09col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LC08coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC08col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LE07coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LE07col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT05coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT05col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT04coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT04col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">LC09coly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LC08coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LE07coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT05coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT04coly</span><span class="p">)</span>

        <span class="n">quarter</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">quarter</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">quarter</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">quarter</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Make a dummy image for missing years.</span>
    <span class="n">bandNames</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">])</span>
    <span class="n">fillerValues</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bandNames</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
    <span class="n">dummyImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">fillerValues</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">bandNames</span><span class="p">)</span><span class="o">.</span><span class="n">selfMask</span><span class="p">()</span><span class="o">.</span><span class="n">int16</span><span class="p">()</span>

    <span class="c1"># Make list of /quarterly/monthly image composites.</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span>
        <span class="n">years</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">years</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getAnnualComp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
        <span class="n">quarters</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span><span class="p">,</span>
            <span class="s2">&quot;quarter&quot;</span><span class="p">,</span>
            <span class="n">date_format</span><span class="p">,</span>
            <span class="n">step</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">quarters</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getQuarterlyComp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span><span class="p">,</span>
            <span class="s2">&quot;month&quot;</span><span class="p">,</span>
            <span class="n">date_format</span><span class="p">,</span>
            <span class="n">step</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">months</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getMonthlyComp</span><span class="p">)</span>

    <span class="c1"># Convert image composite list to collection</span>
    <span class="n">imgCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">imgList</span><span class="p">)</span>

    <span class="n">imgCol</span> <span class="o">=</span> <span class="n">imgCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">({</span><span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="n">roi</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()})</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">imgCol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.landsat_timeseries_legacy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">landsat_timeseries_legacy</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="mi">2021</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;06-10&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;09-20&#39;</span><span class="p">,</span> <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.timelapse.landsat_timeseries_legacy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates an annual Landsat ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 1984.</p></td>
        <td><code>1984</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to 2021.</p></td>
        <td><code>2021</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '06-10'.</p></td>
        <td><code>&#39;06-10&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '09-20'.</p></td>
        <td><code>&#39;09-20&#39;</code></td>
      </tr>
      <tr>
        <td><code>apply_fmask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Format of the date. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns an ImageCollection containing annual Landsat images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">landsat_timeseries_legacy</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">1984</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="mi">2021</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;06-10&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;09-20&quot;</span><span class="p">,</span>
    <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an annual Landsat ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.</span>
<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 1984.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to 2021.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;06-10&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;09-20&#39;.</span>
<span class="sd">        apply_fmask (bool, optional): Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        date_format (str, optional): Format of the date. Defaults to None.</span>
<span class="sd">    Returns:</span>
<span class="sd">        object: Returns an ImageCollection containing annual Landsat images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">################################################################################</span>
    <span class="c1"># Input and output parameters.</span>
    <span class="kn">import</span> <span class="nn">re</span>

    <span class="c1"># import datetime</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not convert the provided roi to ee.Geometry&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="n">feq_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quarter&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">date_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date_format</span> <span class="o">=</span> <span class="n">feq_dict</span><span class="p">[</span><span class="n">frequency</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">feq_dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;frequency must be year, quarter, or month.&quot;</span><span class="p">)</span>

    <span class="c1">################################################################################</span>

    <span class="c1"># Setup vars to get dates.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_year</span> <span class="o">&gt;=</span> <span class="mi">1984</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start_year</span> <span class="o">&lt;</span> <span class="mi">2021</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The start year must be an integer &gt;= 1984.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_year</span> <span class="o">&gt;</span> <span class="mi">1984</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_year</span> <span class="o">&lt;=</span> <span class="mi">2021</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The end year must be an integer &lt;= 2021.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[0-9]</span><span class="si">{2}</span><span class="s2">-[0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;[0-9]</span><span class="si">{2}</span><span class="s2">-[0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end_date</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The start date and end date must be month-day, such as 06-10, 09-20&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">end_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input dates are invalid.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">days_between</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">d2</span> <span class="o">-</span> <span class="n">d1</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>

    <span class="n">n_days</span> <span class="o">=</span> <span class="n">days_between</span><span class="p">(</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">start_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">end_date</span>
    <span class="p">)</span>
    <span class="n">start_month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="c1"># start_date = str(start_year) + &quot;-&quot; + start_date</span>
    <span class="c1"># end_date = str(end_year) + &quot;-&quot; + end_date</span>

    <span class="c1"># # Define a collection filter by date, bounds, and quality.</span>
    <span class="c1"># def colFilter(col, aoi):  # , startDate, endDate):</span>
    <span class="c1">#     return(col.filterBounds(aoi))</span>

    <span class="c1"># Landsat collection preprocessingEnabled</span>
    <span class="c1"># Get Landsat surface reflectance collections for OLI, ETM+ and TM sensors.</span>
    <span class="n">LC08col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LC08/C01/T1_SR&quot;</span><span class="p">)</span>
    <span class="n">LE07col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LE07/C01/T1_SR&quot;</span><span class="p">)</span>
    <span class="n">LT05col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LT05/C01/T1_SR&quot;</span><span class="p">)</span>
    <span class="n">LT04col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;LANDSAT/LT04/C01/T1_SR&quot;</span><span class="p">)</span>

    <span class="c1"># Define a collection filter by date, bounds, and quality.</span>
    <span class="k">def</span> <span class="nf">colFilter</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">col</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
        <span class="c1"># .filter(&#39;CLOUD_COVER &lt; 5&#39;)</span>
        <span class="c1"># .filter(&#39;GEOMETRIC_RMSE_MODEL &lt; 15&#39;)</span>
        <span class="c1"># .filter(&#39;IMAGE_QUALITY == 9 || IMAGE_QUALITY_OLI == 9&#39;))</span>

    <span class="c1"># Function to get and rename bands of interest from OLI.</span>
    <span class="k">def</span> <span class="nf">renameOli</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B5&quot;</span><span class="p">,</span> <span class="s2">&quot;B6&quot;</span><span class="p">,</span> <span class="s2">&quot;B7&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># Function to get and rename bands of interest from ETM+.</span>
    <span class="k">def</span> <span class="nf">renameEtm</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;B1&quot;</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B5&quot;</span><span class="p">,</span> <span class="s2">&quot;B7&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># Add NBR for LandTrendr segmentation.</span>
    <span class="k">def</span> <span class="nf">calcNbr</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">([</span><span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;NBR&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">int16</span><span class="p">()</span>

    <span class="c1"># Define function to mask out clouds and cloud shadows in images.</span>
    <span class="c1"># Use CFmask band included in USGS Landsat SR image product.</span>
    <span class="k">def</span> <span class="nf">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">cloudShadowBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span>
        <span class="n">cloudsBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span>
        <span class="n">qa</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;pixel_qa&quot;</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudShadowBitMask</span><span class="p">)</span>
            <span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudsBitMask</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

    <span class="c1"># Define function to prepare OLI images.</span>
    <span class="k">def</span> <span class="nf">prepOli</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">img</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">renameOli</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">apply_fmask</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">copyProperties</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">orig</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
            <span class="s2">&quot;bicubic&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Define function to prepare ETM+ images.</span>
    <span class="k">def</span> <span class="nf">prepEtm</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">img</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">renameEtm</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">apply_fmask</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">copyProperties</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">orig</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
            <span class="s2">&quot;bicubic&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get annual median collection.</span>
    <span class="k">def</span> <span class="nf">getAnnualComp</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">fromYMD</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">start_month</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">start_day</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">n_days</span><span class="p">),</span> <span class="s2">&quot;day&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">LC08coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC08col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LE07coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LE07col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT05coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT05col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT04coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT04col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">LC08coly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LE07coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT05coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT04coly</span><span class="p">)</span>

        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">yearImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">yearImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calcNbr</span><span class="p">(</span><span class="n">yearImg</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Get monthly median collection.</span>
    <span class="k">def</span> <span class="nf">getMonthlyComp</span><span class="p">(</span><span class="n">startDate</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">LC08coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC08col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LE07coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LE07col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT05coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT05col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT04coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT04col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">LC08coly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LE07coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT05coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT04coly</span><span class="p">)</span>

        <span class="n">monthImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">monthImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">monthImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">monthImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calcNbr</span><span class="p">(</span><span class="n">monthImg</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Get quarterly median collection.</span>
    <span class="k">def</span> <span class="nf">getQuarterlyComp</span><span class="p">(</span><span class="n">startDate</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span>

        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">LC08coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LC08col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepOli</span><span class="p">)</span>
        <span class="n">LE07coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LE07col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT05coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT05col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>
        <span class="n">LT04coly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">LT04col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepEtm</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">LC08coly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LE07coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT05coly</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LT04coly</span><span class="p">)</span>

        <span class="n">quarter</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">quarter</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">quarter</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calcNbr</span><span class="p">(</span><span class="n">quarter</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1">################################################################################</span>

    <span class="c1"># Make a dummy image for missing years.</span>
    <span class="n">bandNames</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_qa&quot;</span><span class="p">])</span>
    <span class="n">fillerValues</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bandNames</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
    <span class="n">dummyImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">fillerValues</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">bandNames</span><span class="p">)</span><span class="o">.</span><span class="n">selfMask</span><span class="p">()</span><span class="o">.</span><span class="n">int16</span><span class="p">()</span>

    <span class="c1"># ################################################################################</span>
    <span class="c1"># # Get a list of years</span>
    <span class="c1"># years = ee.List.sequence(start_year, end_year)</span>

    <span class="c1"># ################################################################################</span>
    <span class="c1"># # Make list of annual image composites.</span>
    <span class="c1"># imgList = years.map(getAnnualComp)</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span>
        <span class="n">years</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">years</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getAnnualComp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
        <span class="n">quarters</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span><span class="p">,</span> <span class="s2">&quot;quarter&quot;</span><span class="p">,</span> <span class="n">date_format</span>
        <span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">quarters</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getQuarterlyComp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">date_format</span>
        <span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">months</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getMonthlyComp</span><span class="p">)</span>

    <span class="c1"># Convert image composite list to collection</span>
    <span class="n">imgCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">imgList</span><span class="p">)</span>

    <span class="n">imgCol</span> <span class="o">=</span> <span class="n">imgCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">({</span><span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="n">roi</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()})</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">imgCol</span>

    <span class="c1"># ################################################################################</span>
    <span class="c1"># # Run LandTrendr.</span>
    <span class="c1"># lt = ee.Algorithms.TemporalSegmentation.LandTrendr(</span>
    <span class="c1">#     timeSeries=imgCol.select([&#39;NBR&#39;, &#39;SWIR1&#39;, &#39;NIR&#39;, &#39;Green&#39;]),</span>
    <span class="c1">#     maxSegments=10,</span>
    <span class="c1">#     spikeThreshold=0.7,</span>
    <span class="c1">#     vertexCountOvershoot=3,</span>
    <span class="c1">#     preventOneYearRecovery=True,</span>
    <span class="c1">#     recoveryThreshold=0.5,</span>
    <span class="c1">#     pvalThreshold=0.05,</span>
    <span class="c1">#     bestModelProportion=0.75,</span>
    <span class="c1">#     minObservationsNeeded=6)</span>

    <span class="c1"># ################################################################################</span>
    <span class="c1"># # Get fitted imagery. This starts export tasks.</span>
    <span class="c1"># def getYearStr(year):</span>
    <span class="c1">#     return(ee.String(&#39;yr_&#39;).cat(ee.Algorithms.String(year).slice(0,4)))</span>

    <span class="c1"># yearsStr = years.map(getYearStr)</span>

    <span class="c1"># r = lt.select([&#39;SWIR1_fit&#39;]).arrayFlatten([yearsStr]).toShort()</span>
    <span class="c1"># g = lt.select([&#39;NIR_fit&#39;]).arrayFlatten([yearsStr]).toShort()</span>
    <span class="c1"># b = lt.select([&#39;Green_fit&#39;]).arrayFlatten([yearsStr]).toShort()</span>

    <span class="c1"># for i, c in zip([r, g, b], [&#39;r&#39;, &#39;g&#39;, &#39;b&#39;]):</span>
    <span class="c1">#     descr = &#39;mamore-river-&#39;+c</span>
    <span class="c1">#     name = &#39;users/user/&#39;+descr</span>
    <span class="c1">#     print(name)</span>
    <span class="c1">#     task = ee.batch.Export.image.toAsset(</span>
    <span class="c1">#     image=i,</span>
    <span class="c1">#     region=roi.getInfo()[&#39;coordinates&#39;],</span>
    <span class="c1">#     assetId=name,</span>
    <span class="c1">#     description=descr,</span>
    <span class="c1">#     scale=30,</span>
    <span class="c1">#     crs=&#39;EPSG:3857&#39;,</span>
    <span class="c1">#     maxPixels=1e13)</span>
    <span class="c1">#     task.start()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.landsat_ts_norm_diff" class="doc doc-heading">
<code class="highlight language-python"><span class="n">landsat_ts_norm_diff</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span> <span class="s1">&#39;SWIR1&#39;</span><span class="p">],</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#geemap.timelapse.landsat_ts_norm_diff" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Computes a normalized difference index based on a Landsat timeseries.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection</code></td>
        <td><code>ee.ImageCollection</code></td>
        <td><p>A Landsat timeseries.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to use for computing normalized difference. Defaults to ['Green', 'SWIR1'].</p></td>
        <td><code>[&#39;Green&#39;, &#39;SWIR1&#39;]</code></td>
      </tr>
      <tr>
        <td><code>threshold</code></td>
        <td><code>float</code></td>
        <td><p>The threshold to extract features. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>An ImageCollection containing images with values greater than the specified threshold.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">landsat_ts_norm_diff</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR1&quot;</span><span class="p">],</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes a normalized difference index based on a Landsat timeseries.</span>

<span class="sd">    Args:</span>
<span class="sd">        collection (ee.ImageCollection): A Landsat timeseries.</span>
<span class="sd">        bands (list, optional): The bands to use for computing normalized difference. Defaults to [&#39;Green&#39;, &#39;SWIR1&#39;].</span>
<span class="sd">        threshold (float, optional): The threshold to extract features. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: An ImageCollection containing images with values greater than the specified threshold.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nd_images</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
        <span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
        <span class="o">.</span><span class="n">copyProperties</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">nd_images</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.landsat_ts_norm_diff_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">landsat_ts_norm_diff_gif</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.timelapse.landsat_ts_norm_diff_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>[summary]</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection</code></td>
        <td><code>ee.ImageCollection</code></td>
        <td><p>The normalized difference Landsat timeseires.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output animated GIF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>Visualization parameters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>list</code></td>
        <td><p>The palette to use for visualizing the timelapse. Defaults to ['black', 'blue']. The first color in the list is the background color.</p></td>
        <td><code>[&#39;black&#39;, &#39;blue&#39;]</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the output gif will be converted to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the output animated GIF.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">landsat_ts_norm_diff_gif</span><span class="p">(</span>
    <span class="n">collection</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">    Args:</span>
<span class="sd">        collection (ee.ImageCollection): The normalized difference Landsat timeseires.</span>
<span class="sd">        out_gif (str, optional): File path to the output animated GIF. Defaults to None.</span>
<span class="sd">        vis_params (dict, optional): Visualization parameters. Defaults to None.</span>
<span class="sd">        palette (list, optional): The palette to use for visualizing the timelapse. Defaults to [&#39;black&#39;, &#39;blue&#39;]. The first color in the list is the background color.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        mp4 (bool, optional): If True, the output gif will be converted to mp4. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the output animated GIF.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">())</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">)</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;Downloads&quot;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;landsat_ts_nd_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.gif&quot;</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The output file must end with .gif&quot;</span><span class="p">)</span>

    <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nd&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span>
        <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">palette</span>

    <span class="n">video_args</span> <span class="o">=</span> <span class="n">vis_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dimensions</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roi</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;framesPerSecond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frames_per_second</span>
    <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;EPSG:3857&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;bands&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">video_args</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span>

    <span class="n">download_ee_video</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">video_args</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
        <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
        <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
        <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.make_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_gif</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clean_up</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.timelapse.make_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a gif from a list of images.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>images</code></td>
        <td><code>list | str</code></td>
        <td><p>The list of images or input directory to create the gif from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output gif.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>The extension of the images. Defaults to 'jpg'.</p></td>
        <td><code>&#39;jpg&#39;</code></td>
      </tr>
      <tr>
        <td><code>fps</code></td>
        <td><code>int</code></td>
        <td><p>The frames per second of the gif. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>The number of times to loop the gif. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the gif to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_gif</span><span class="p">(</span>
    <span class="n">images</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">out_gif</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;jpg&quot;</span><span class="p">,</span>
    <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">loop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">clean_up</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a gif from a list of images.</span>

<span class="sd">    Args:</span>
<span class="sd">        images (list | str): The list of images or input directory to create the gif from.</span>
<span class="sd">        out_gif (str): File path to the output gif.</span>
<span class="sd">        ext (str, optional): The extension of the images. Defaults to &#39;jpg&#39;.</span>
<span class="sd">        fps (int, optional): The frames per second of the gif. Defaults to 10.</span>
<span class="sd">        loop (int, optional): The number of times to loop the gif. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the gif to mp4. Defaults to False.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No images found in the input directory.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;images must be a list or a path to the image directory.&quot;</span><span class="p">)</span>

    <span class="n">images</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">]</span>
    <span class="n">frame_one</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">frame_one</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">out_gif</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">,</span>
        <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
        <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">),</span>
        <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tool</span><span class="p">(</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2"> -vcodec libx264 -crf 25 -pix_fmt yuv420p </span><span class="si">{</span><span class="n">out_mp4</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create mp4 file.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clean_up</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.merge_gifs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_gifs</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span></code>


<a href="#geemap.timelapse.merge_gifs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Merge multiple gifs into one.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gifs</code></td>
        <td><code>str | list</code></td>
        <td><p>The input gifs as a list or a directory path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception when gifsicle is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">merge_gifs</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge multiple gifs into one.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gifs (str | list): The input gifs as a list or a directory path.</span>
<span class="sd">        out_gif (str): The output gif.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception:  Raise exception when gifsicle is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">):</span>
            <span class="n">in_gifs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="s2">&quot;*.gif&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;in_gifs must be a list.&quot;</span><span class="p">)</span>

        <span class="n">in_gifs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">)</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;gifsicle </span><span class="si">{</span><span class="n">in_gifs</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;gifsicle is not installed. Run &#39;sudo apt-get install -y gifsicle&#39; to install it.&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.modis_ndvi_doy_ts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modis_ndvi_doy_ts</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;Terra&#39;</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.timelapse.modis_ndvi_doy_ts" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create MODIS NDVI timeseries. The source code is adapted from https://developers.google.com/earth-engine/tutorials/community/modis-ndvi-time-series-animation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str</code></td>
        <td><p>Either "Terra" or "Aqua". Defaults to "Terra".</p></td>
        <td><code>&#39;Terra&#39;</code></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>str</code></td>
        <td><p>Either the "NDVI" or "EVI" band. Defaults to "NDVI".</p></td>
        <td><code>&#39;NDVI&#39;</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date used to filter the image collection, e.g., "2013-01-01". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date used to filter the image collection. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The geometry used to filter the image collection. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>The MODIS NDVI time series.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">modis_ndvi_doy_ts</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Terra&quot;</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s2">&quot;NDVI&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create MODIS NDVI timeseries. The source code is adapted from https://developers.google.com/earth-engine/tutorials/community/modis-ndvi-time-series-animation.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str, optional): Either &quot;Terra&quot; or &quot;Aqua&quot;. Defaults to &quot;Terra&quot;.</span>
<span class="sd">        band (str, optional): Either the &quot;NDVI&quot; or &quot;EVI&quot; band. Defaults to &quot;NDVI&quot;.</span>
<span class="sd">        start_date (str, optional): The start date used to filter the image collection, e.g., &quot;2013-01-01&quot;. Defaults to None.</span>
<span class="sd">        end_date (str, optional): The end date used to filter the image collection. Defaults to None.</span>
<span class="sd">        region (ee.Geometry, optional): The geometry used to filter the image collection. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: The MODIS NDVI time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Terra&quot;</span><span class="p">,</span> <span class="s2">&quot;Aqua&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;data must be &#39;Terra&#39; or &#39;Aqua&#39;.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">band</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;NDVI&quot;</span><span class="p">,</span> <span class="s2">&quot;EVI&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;band must be &#39;NDVI&#39; or &#39;EVI&#39;.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;region must be an ee.Geometry or ee.FeatureCollection.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s2">&quot;Terra&quot;</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;MODIS/006/MOD13A2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">band</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;MODIS/006/MYD13A2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">band</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_doy</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">doy</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">getRelative</span><span class="p">(</span><span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;doy&quot;</span><span class="p">,</span> <span class="n">doy</span><span class="p">)</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">set_doy</span><span class="p">)</span>

    <span class="c1"># Get a collection of distinct images by &#39;doy&#39;.</span>
    <span class="n">distinctDOY</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s2">&quot;2013-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2014-01-01&quot;</span><span class="p">)</span>

    <span class="c1"># Define a filter that identifies which images from the complete</span>
    <span class="c1"># collection match the DOY from the distinct DOY collection.</span>
    <span class="nb">filter</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;leftField&quot;</span><span class="p">:</span> <span class="s2">&quot;doy&quot;</span><span class="p">,</span> <span class="s2">&quot;rightField&quot;</span><span class="p">:</span> <span class="s2">&quot;doy&quot;</span><span class="p">})</span>

    <span class="c1"># Define a join.</span>
    <span class="n">join</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Join</span><span class="o">.</span><span class="n">saveAll</span><span class="p">(</span><span class="s2">&quot;doy_matches&quot;</span><span class="p">)</span>

    <span class="c1"># Apply the join and convert the resulting FeatureCollection to an</span>
    <span class="c1"># ImageCollection.</span>
    <span class="n">joinCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">join</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">distinctDOY</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">filter</span><span class="p">))</span>

    <span class="c1"># Apply median reduction among matching DOY collections.</span>

    <span class="k">def</span> <span class="nf">match_doy</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">doyCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;doy_matches&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">doyCol</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="n">comp</span> <span class="o">=</span> <span class="n">joinCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">match_doy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">comp</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">region</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">comp</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.modis_ndvi_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modis_ndvi_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;Terra&#39;</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">framesPerSecond</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;3%&#39;</span><span class="p">,</span> <span class="s1">&#39;3%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.modis_ndvi_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create MODIS NDVI timelapse. The source code is adapted from https://developers.google.com/earth-engine/tutorials/community/modis-ndvi-time-series-animation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The geometry used to filter the image collection. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>str</code></td>
        <td><p>Either "Terra" or "Aqua". Defaults to "Terra".</p></td>
        <td><code>&#39;Terra&#39;</code></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>str</code></td>
        <td><p>Either the "NDVI" or "EVI" band. Defaults to "NDVI".</p></td>
        <td><code>&#39;NDVI&#39;</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date used to filter the image collection, e.g., "2013-01-01". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date used to filter the image collection. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;3%&#39;, &#39;3%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;#ffffff&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the output gif to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">modis_ndvi_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="s2">&quot;Terra&quot;</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="s2">&quot;NDVI&quot;</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">framesPerSecond</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;3%&quot;</span><span class="p">,</span> <span class="s2">&quot;3%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create MODIS NDVI timelapse. The source code is adapted from https://developers.google.com/earth-engine/tutorials/community/modis-ndvi-time-series-animation.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (ee.Geometry, optional): The geometry used to filter the image collection. Defaults to None.</span>
<span class="sd">        out_gif (str): The output gif file path. Defaults to None.</span>
<span class="sd">        data (str, optional): Either &quot;Terra&quot; or &quot;Aqua&quot;. Defaults to &quot;Terra&quot;.</span>
<span class="sd">        band (str, optional): Either the &quot;NDVI&quot; or &quot;EVI&quot; band. Defaults to &quot;NDVI&quot;.</span>
<span class="sd">        start_date (str, optional): The start date used to filter the image collection, e.g., &quot;2013-01-01&quot;. Defaults to None.</span>
<span class="sd">        end_date (str, optional): The end date used to filter the image collection. Defaults to None.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the output gif to mp4. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">18.6983</span><span class="p">,</span> <span class="mf">38.1446</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">18.6983</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.1630</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">52.2293</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.1630</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">52.2293</span><span class="p">,</span> <span class="mf">38.1446</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;modis_ndvi_</span><span class="si">{</span><span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">.gif&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">modis_ndvi_doy_ts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span>

        <span class="c1"># Define RGB visualization parameters.</span>
        <span class="n">visParams</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">9000.0</span><span class="p">,</span>
            <span class="s2">&quot;palette&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;FFFFFF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CE7E45&quot;</span><span class="p">,</span>
                <span class="s2">&quot;DF923D&quot;</span><span class="p">,</span>
                <span class="s2">&quot;F1B555&quot;</span><span class="p">,</span>
                <span class="s2">&quot;FCD163&quot;</span><span class="p">,</span>
                <span class="s2">&quot;99B718&quot;</span><span class="p">,</span>
                <span class="s2">&quot;74A901&quot;</span><span class="p">,</span>
                <span class="s2">&quot;66A000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;529400&quot;</span><span class="p">,</span>
                <span class="s2">&quot;3E8601&quot;</span><span class="p">,</span>
                <span class="s2">&quot;207401&quot;</span><span class="p">,</span>
                <span class="s2">&quot;056201&quot;</span><span class="p">,</span>
                <span class="s2">&quot;004C00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;023B01&quot;</span><span class="p">,</span>
                <span class="s2">&quot;012E01&quot;</span><span class="p">,</span>
                <span class="s2">&quot;011D01&quot;</span><span class="p">,</span>
                <span class="s2">&quot;011301&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">}</span>

        <span class="c1"># Create RGB visualization images for use as animation frames.</span>
        <span class="n">rgbVis</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">visParams</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rgbVis</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
                <span class="n">rgbVis</span><span class="p">,</span>
                <span class="n">overlay_data</span><span class="p">,</span>
                <span class="n">overlay_color</span><span class="p">,</span>
                <span class="n">overlay_width</span><span class="p">,</span>
                <span class="n">overlay_opacity</span><span class="p">,</span>
                <span class="n">roi</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Define GIF visualization arguments.</span>
        <span class="n">videoArgs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">roi</span><span class="p">,</span>
            <span class="s2">&quot;dimensions&quot;</span><span class="p">:</span> <span class="n">dimensions</span><span class="p">,</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">crs</span><span class="p">,</span>
            <span class="s2">&quot;framesPerSecond&quot;</span><span class="p">:</span> <span class="n">framesPerSecond</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">download_ee_video</span><span class="p">(</span><span class="n">rgbVis</span><span class="p">,</span> <span class="n">videoArgs</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">rgbVis</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
            <span class="n">text_sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">5</span><span class="p">:]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">add_text_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">xy</span><span class="p">,</span>
                <span class="n">text_sequence</span><span class="p">,</span>
                <span class="n">font_type</span><span class="p">,</span>
                <span class="n">font_size</span><span class="p">,</span>
                <span class="n">font_color</span><span class="p">,</span>
                <span class="n">add_progress_bar</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">framesPerSecond</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_gif</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.modis_ocean_color_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modis_ocean_color_timelapse</span><span class="p">(</span><span class="n">satellite</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colorbar_width</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">colorbar_height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;Sea Surface Temperature (C)&#39;</span><span class="p">,</span> <span class="n">colorbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">colorbar_label_weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">colorbar_tick_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colorbar_bg_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">colorbar_dpi</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">colorbar_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.timelapse.modis_ocean_color_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a ocean color timelapse from MODIS. https://developers.google.com/earth-engine/datasets/catalog/NASA_OCEANDATA_MODIS-Aqua_L3SMI</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>satellite</code></td>
        <td><code>str</code></td>
        <td><p>The satellite to use, can be either "Terra" or "Aqua".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>roi</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of band names to use in the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>The frequency of the timeseries. It must be one of the following: 'year', 'month', 'day', 'hour', 'minute', 'second'. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to use to reduce the collection of images to a single value. It can be one of the following: 'median', 'mean', 'min', 'max', 'variance', 'sum'. Defaults to 'median'.</p></td>
        <td><code>&#39;median&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to 'YYYY-MM-dd'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to render a single-band image in the timelapse. Defaults to None.</p></td>
        <td><code>&#39;coolwarm&#39;</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>add_colorbar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a colorbar to the timelapse. Defaults to False.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>colorbar_width</code></td>
        <td><code>float</code></td>
        <td><p>Width of the colorbar. Defaults to 6.0.</p></td>
        <td><code>6.0</code></td>
      </tr>
      <tr>
        <td><code>colorbar_height</code></td>
        <td><code>float</code></td>
        <td><p>Height of the colorbar. Defaults to 0.4.</p></td>
        <td><code>0.4</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for the colorbar. Defaults to None.</p></td>
        <td><code>&#39;Sea Surface Temperature (C)&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar label. Defaults to 12.</p></td>
        <td><code>12</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label_weight</code></td>
        <td><code>str</code></td>
        <td><p>Font weight for the colorbar label. Defaults to 'normal'.</p></td>
        <td><code>&#39;normal&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_tick_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar ticks. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>colorbar_bg_color</code></td>
        <td><code>str</code></td>
        <td><p>Background color for the colorbar, can be color like "white", "black". Defaults to None.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_orientation</code></td>
        <td><code>str</code></td>
        <td><p>Orientation of the colorbar. Defaults to 'horizontal'.</p></td>
        <td><code>&#39;horizontal&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_dpi</code></td>
        <td><code>str</code></td>
        <td><p>DPI for the colorbar, can be numbers like 100, 300. Defaults to 'figure'.</p></td>
        <td><code>&#39;figure&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the colorbar. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Size of the colorbar. It can be formatted like this: (300, 300). Defaults to (300, 300).</p></td>
        <td><code>(300, 300)</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create an mp4 file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the timelapse gif.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">modis_ocean_color_timelapse</span><span class="p">(</span>
    <span class="n">satellite</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">,</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">colorbar_width</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span>
    <span class="n">colorbar_height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">colorbar_label</span><span class="o">=</span><span class="s2">&quot;Sea Surface Temperature (C)&quot;</span><span class="p">,</span>
    <span class="n">colorbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">colorbar_label_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">colorbar_tick_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">colorbar_bg_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">colorbar_dpi</span><span class="o">=</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span>
    <span class="n">colorbar_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a ocean color timelapse from MODIS. https://developers.google.com/earth-engine/datasets/catalog/NASA_OCEANDATA_MODIS-Aqua_L3SMI</span>

<span class="sd">    Args:</span>
<span class="sd">        satellite (str): The satellite to use, can be either &quot;Terra&quot; or &quot;Aqua&quot;.</span>
<span class="sd">        start_date (str): The start date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        end_date (str): The end date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        roi (ee.Geometry, optional): The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</span>
<span class="sd">        bands (list, optional): A list of band names to use in the timelapse. Defaults to None.</span>
<span class="sd">        frequency (str, optional): The frequency of the timeseries. It must be one of the following: &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;, &#39;minute&#39;, &#39;second&#39;. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional):  The reducer to use to reduce the collection of images to a single value. It can be one of the following: &#39;median&#39;, &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, &#39;variance&#39;, &#39;sum&#39;. Defaults to &#39;median&#39;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        out_gif (str): The output gif file path. Defaults to None.</span>
<span class="sd">        palette (list, optional): A list of colors to render a single-band image in the timelapse. Defaults to None.</span>
<span class="sd">        vis_params (dict, optional): A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        add_colorbar (bool, optional): Whether to add a colorbar to the timelapse. Defaults to False.</span>
<span class="sd">        colorbar_width (float, optional): Width of the colorbar. Defaults to 6.0.</span>
<span class="sd">        colorbar_height (float, optional): Height of the colorbar. Defaults to 0.4.</span>
<span class="sd">        colorbar_label (str, optional): Label for the colorbar. Defaults to None.</span>
<span class="sd">        colorbar_label_size (int, optional): Font size for the colorbar label. Defaults to 12.</span>
<span class="sd">        colorbar_label_weight (str, optional): Font weight for the colorbar label. Defaults to &#39;normal&#39;.</span>
<span class="sd">        colorbar_tick_size (int, optional): Font size for the colorbar ticks. Defaults to 10.</span>
<span class="sd">        colorbar_bg_color (str, optional): Background color for the colorbar, can be color like &quot;white&quot;, &quot;black&quot;. Defaults to None.</span>
<span class="sd">        colorbar_orientation (str, optional): Orientation of the colorbar. Defaults to &#39;horizontal&#39;.</span>
<span class="sd">        colorbar_dpi (str, optional): DPI for the colorbar, can be numbers like 100, 300. Defaults to &#39;figure&#39;.</span>
<span class="sd">        colorbar_xy (tuple, optional): Lower left corner of the colorbar. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        colorbar_size (tuple, optional): Size of the colorbar. It can be formatted like this: (300, 300). Defaults to (300, 300).</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to create an mp4 file. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the timelapse gif.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">modis_ocean_color_timeseries</span><span class="p">(</span>
        <span class="n">satellite</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">bands</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">reducer</span><span class="p">,</span> <span class="n">date_format</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sst&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">palette</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="s2">&quot;coolwarm&quot;</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">BBox</span><span class="p">(</span><span class="o">-</span><span class="mf">99.755133</span><span class="p">,</span> <span class="mf">18.316722</span><span class="p">,</span> <span class="o">-</span><span class="mf">79.761194</span><span class="p">,</span> <span class="mf">31.206929</span><span class="p">)</span>

    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">create_timelapse</span><span class="p">(</span>
        <span class="n">collection</span><span class="p">,</span>
        <span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="p">,</span>
        <span class="n">roi</span><span class="p">,</span>
        <span class="n">bands</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">,</span>
        <span class="n">reducer</span><span class="p">,</span>
        <span class="n">date_format</span><span class="p">,</span>
        <span class="n">out_gif</span><span class="p">,</span>
        <span class="n">palette</span><span class="p">,</span>
        <span class="n">vis_params</span><span class="p">,</span>
        <span class="n">dimensions</span><span class="p">,</span>
        <span class="n">frames_per_second</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">,</span>
        <span class="n">overlay_data</span><span class="p">,</span>
        <span class="n">overlay_color</span><span class="p">,</span>
        <span class="n">overlay_width</span><span class="p">,</span>
        <span class="n">overlay_opacity</span><span class="p">,</span>
        <span class="n">title</span><span class="p">,</span>
        <span class="n">title_xy</span><span class="p">,</span>
        <span class="n">add_text</span><span class="p">,</span>
        <span class="n">text_xy</span><span class="p">,</span>
        <span class="n">text_sequence</span><span class="p">,</span>
        <span class="n">font_type</span><span class="p">,</span>
        <span class="n">font_size</span><span class="p">,</span>
        <span class="n">font_color</span><span class="p">,</span>
        <span class="n">add_progress_bar</span><span class="p">,</span>
        <span class="n">progress_bar_color</span><span class="p">,</span>
        <span class="n">progress_bar_height</span><span class="p">,</span>
        <span class="n">add_colorbar</span><span class="p">,</span>
        <span class="n">colorbar_width</span><span class="p">,</span>
        <span class="n">colorbar_height</span><span class="p">,</span>
        <span class="n">colorbar_label</span><span class="p">,</span>
        <span class="n">colorbar_label_size</span><span class="p">,</span>
        <span class="n">colorbar_label_weight</span><span class="p">,</span>
        <span class="n">colorbar_tick_size</span><span class="p">,</span>
        <span class="n">colorbar_bg_color</span><span class="p">,</span>
        <span class="n">colorbar_orientation</span><span class="p">,</span>
        <span class="n">colorbar_dpi</span><span class="p">,</span>
        <span class="n">colorbar_xy</span><span class="p">,</span>
        <span class="n">colorbar_size</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">,</span>
        <span class="n">mp4</span><span class="p">,</span>
        <span class="n">fading</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">out_gif</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.modis_ocean_color_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modis_ocean_color_timeseries</span><span class="p">(</span><span class="n">satellite</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.modis_ocean_color_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a ocean color timeseries from MODIS. https://developers.google.com/earth-engine/datasets/catalog/NASA_OCEANDATA_MODIS-Aqua_L3SMI</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>satellite</code></td>
        <td><code>str</code></td>
        <td><p>The satellite to use, can be either "Terra" or "Aqua".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date of the timeseries. It must be formatted like this: 'YYYY-MM-dd'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The list of bands to use to create the timeseries. It must be a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>The frequency of the timeseries. It must be one of the following: 'year', 'month', 'day'. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to use to reduce the collection of images to a single value. It can be one of the following: 'median', 'mean', 'min', 'max', 'variance', 'sum'. Defaults to 'median'.</p></td>
        <td><code>&#39;median&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to 'YYYY-MM-dd'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>parallel_scale</code></td>
        <td><code>int</code></td>
        <td><p>A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ee.ImageCollection</code></td>
      <td><p>The timeseries.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">modis_ocean_color_timeseries</span><span class="p">(</span>
    <span class="n">satellite</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">,</span>
    <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
    <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a ocean color timeseries from MODIS. https://developers.google.com/earth-engine/datasets/catalog/NASA_OCEANDATA_MODIS-Aqua_L3SMI</span>

<span class="sd">    Args:</span>
<span class="sd">        satellite (str): The satellite to use, can be either &quot;Terra&quot; or &quot;Aqua&quot;.</span>
<span class="sd">        start_date (str): The start date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        end_date (str): The end date of the timeseries. It must be formatted like this: &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        region (ee.Geometry, optional): The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</span>
<span class="sd">        bands (list, optional): The list of bands to use to create the timeseries. It must be a list of strings. Defaults to None.</span>
<span class="sd">        frequency (str, optional): The frequency of the timeseries. It must be one of the following: &#39;year&#39;, &#39;month&#39;, &#39;day&#39;. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional):  The reducer to use to reduce the collection of images to a single value. It can be one of the following: &#39;median&#39;, &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, &#39;variance&#39;, &#39;sum&#39;. Defaults to &#39;median&#39;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        parallel_scale (int, optional): A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ee.ImageCollection: The timeseries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">satellite</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Terra&quot;</span><span class="p">,</span> <span class="s2">&quot;Aqua&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Satellite must be &#39;Terra&#39; or &#39;Aqua&#39;.&quot;</span><span class="p">)</span>

    <span class="n">allowed_frequency</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;quarter&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;week&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">frequency</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_frequency</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;Frequency must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">allowed_frequency</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;region must be an ee.Geometry or ee.FeatureCollection.&quot;</span><span class="p">)</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NASA/OCEANDATA/MODIS-</span><span class="si">{</span><span class="n">satellite</span><span class="si">}</span><span class="s2">/L3SMI&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span>
        <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span>
    <span class="p">)</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">create_timeseries</span><span class="p">(</span>
        <span class="n">col</span><span class="p">,</span>
        <span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="p">,</span>
        <span class="n">region</span><span class="p">,</span>
        <span class="n">bands</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">,</span>
        <span class="n">reducer</span><span class="p">,</span>
        <span class="n">drop_empty</span><span class="p">,</span>
        <span class="n">date_format</span><span class="p">,</span>
        <span class="n">parallel_scale</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ts</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.modis_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modis_timeseries</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;MODIS/006/MOD13A2&#39;</span><span class="p">,</span> <span class="n">band_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;12-31&#39;</span><span class="p">)</span></code>


<a href="#geemap.timelapse.modis_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a Monthly MODIS ImageCollection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>The asset id the MODIS ImageCollection.</p></td>
        <td><code>&#39;MODIS/006/MOD13A2&#39;</code></td>
      </tr>
      <tr>
        <td><code>band_name</code></td>
        <td><code>str</code></td>
        <td><p>The band name of the image to use.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 1984.</p></td>
        <td><code>2001</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which is the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '06-10'.</p></td>
        <td><code>&#39;01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '09-20'.</p></td>
        <td><code>&#39;12-31&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns an ImageCollection containing month MODIS images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">modis_timeseries</span><span class="p">(</span>
    <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;MODIS/006/MOD13A2&quot;</span><span class="p">,</span>
    <span class="n">band_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a Monthly MODIS ImageCollection.</span>
<span class="sd">    Args:</span>
<span class="sd">        asset_id (str, optional): The asset id the MODIS ImageCollection.</span>
<span class="sd">        band_name (str, optional): The band name of the image to use.</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 1984.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which is the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;06-10&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;09-20&#39;.</span>
<span class="sd">    Returns:</span>
<span class="sd">        object: Returns an ImageCollection containing month MODIS images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

        <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">band_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">band_name</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">band_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
                <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span>
                    <span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
                <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span>
                    <span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clipToCollection</span><span class="p">(</span><span class="n">roi</span><span class="p">))</span>
                <span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">start_date</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">end_date</span>

        <span class="n">seq</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">monthly_modis</span><span class="p">(</span><span class="n">start_d</span><span class="p">):</span>
            <span class="n">end_d</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">start_d</span><span class="p">)</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_d</span><span class="p">,</span> <span class="n">end_d</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

        <span class="n">images</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">monthly_modis</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">images</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.naip_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">naip_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2003</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.naip_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a timelapse from NAIP imagery.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int | str</code></td>
        <td><p>The start year of the timeseries. It must be formatted like this: 'YYYY'. Defaults to 2003.</p></td>
        <td><code>2003</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int | str</code></td>
        <td><p>The end year of the timeseries. It must be formatted like this: 'YYYY'. Defaults to None, which will use the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of band names to use in the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to render a single-band image in the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create an mp4 file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step size to use when creating the date sequence. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the timelapse gif.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">naip_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2003</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a timelapse from NAIP imagery.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (ee.Geometry): The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</span>
<span class="sd">        start_year (int | str, optional): The start year of the timeseries. It must be formatted like this: &#39;YYYY&#39;. Defaults to 2003.</span>
<span class="sd">        end_year (int | str, optional): The end year of the timeseries. It must be formatted like this: &#39;YYYY&#39;. Defaults to None, which will use the current year.</span>
<span class="sd">        out_gif (str): The output gif file path. Defaults to None.</span>
<span class="sd">        bands (list, optional): A list of band names to use in the timelapse. Defaults to None.</span>
<span class="sd">        palette (list, optional): A list of colors to render a single-band image in the timelapse. Defaults to None.</span>
<span class="sd">        vis_params (dict, optional): A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to create an mp4 file. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>
<span class="sd">        step (int, optional): The step size to use when creating the date sequence. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the timelapse gif.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

        <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;USDA/NAIP/DOQQ&quot;</span><span class="p">)</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="s2">&quot;year&quot;</span>
        <span class="n">reducer</span> <span class="o">=</span> <span class="s2">&quot;median&quot;</span>
        <span class="n">date_format</span> <span class="o">=</span> <span class="s2">&quot;YYYY&quot;</span>

        <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;N&quot;</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">:</span>
            <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">listContains</span><span class="p">(</span><span class="s2">&quot;system:band_names&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">create_timelapse</span><span class="p">(</span>
            <span class="n">collection</span><span class="p">,</span>
            <span class="n">start_date</span><span class="p">,</span>
            <span class="n">end_date</span><span class="p">,</span>
            <span class="n">roi</span><span class="p">,</span>
            <span class="n">bands</span><span class="p">,</span>
            <span class="n">frequency</span><span class="p">,</span>
            <span class="n">reducer</span><span class="p">,</span>
            <span class="n">date_format</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">palette</span><span class="p">,</span>
            <span class="n">vis_params</span><span class="p">,</span>
            <span class="n">dimensions</span><span class="p">,</span>
            <span class="n">frames_per_second</span><span class="p">,</span>
            <span class="n">crs</span><span class="p">,</span>
            <span class="n">overlay_data</span><span class="p">,</span>
            <span class="n">overlay_color</span><span class="p">,</span>
            <span class="n">overlay_width</span><span class="p">,</span>
            <span class="n">overlay_opacity</span><span class="p">,</span>
            <span class="n">title</span><span class="p">,</span>
            <span class="n">title_xy</span><span class="p">,</span>
            <span class="n">add_text</span><span class="p">,</span>
            <span class="n">text_xy</span><span class="p">,</span>
            <span class="n">text_sequence</span><span class="p">,</span>
            <span class="n">font_type</span><span class="p">,</span>
            <span class="n">font_size</span><span class="p">,</span>
            <span class="n">font_color</span><span class="p">,</span>
            <span class="n">add_progress_bar</span><span class="p">,</span>
            <span class="n">progress_bar_color</span><span class="p">,</span>
            <span class="n">progress_bar_height</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">mp4</span><span class="o">=</span><span class="n">mp4</span><span class="p">,</span>
            <span class="n">fading</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.naip_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">naip_timeseries</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2003</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">RGBN</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.naip_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates NAIP annual timeseries</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>An ee.Geometry representing the region of interest. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timeseries. Defaults to 2003.</p></td>
        <td><code>2003</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timeseries. Defaults to None, which will use the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>RGBN</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to retrieve 4-band NAIP imagery only.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step size to use when creating the date sequence. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>An ee.ImageCollection representing annual NAIP imagery.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">naip_timeseries</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2003</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">RGBN</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates NAIP annual timeseries</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): An ee.Geometry representing the region of interest. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timeseries. Defaults to 2003.</span>
<span class="sd">        end_year (int, optional): Ending year for the timeseries. Defaults to None, which will use the current year.</span>
<span class="sd">        RGBN (bool, optional): Whether to retrieve 4-band NAIP imagery only.</span>
<span class="sd">        step (int, optional): The step size to use when creating the date sequence. Defaults to 1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        object: An ee.ImageCollection representing annual NAIP imagery.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

        <span class="k">def</span> <span class="nf">get_annual_NAIP</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;USDA/NAIP/DOQQ&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
                <span class="n">start_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">fromYMD</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">end_date</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">fromYMD</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
                <span class="n">naip</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">RGBN</span><span class="p">:</span>
                    <span class="n">naip</span> <span class="o">=</span> <span class="n">naip</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">listContains</span><span class="p">(</span><span class="s2">&quot;system:band_names&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
                        <span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">naip</span><span class="p">)</span><span class="o">.</span><span class="n">mosaic</span><span class="p">()</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
                        <span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span>
                            <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">naip</span><span class="p">)</span><span class="o">.</span><span class="n">mosaic</span><span class="p">()</span><span class="o">.</span><span class="n">clipToCollection</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">image</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">naip</span><span class="p">)</span><span class="o">.</span><span class="n">mosaic</span><span class="p">())</span>
                <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                        <span class="s2">&quot;system:time_end&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                        <span class="s2">&quot;empty&quot;</span><span class="p">:</span> <span class="n">naip</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="n">years</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="n">years</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">get_annual_NAIP</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">collection</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s2">&quot;empty&quot;</span><span class="p">,</span> <span class="s2">&quot;equals&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.reduce_gif_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.timelapse.reduce_gif_size" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Reduces a GIF image using ffmpeg.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input file path to the GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to the GIF image. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">reduce_gif_size</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduces a GIF image using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input file path to the GIF image.</span>
<span class="sd">        out_gif (str, optional): The output file path to the GIF image. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ffmpeg</span>
    <span class="kn">import</span> <span class="nn">warnings</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tool</span><span class="p">(</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">in_gif</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">in_gif</span> <span class="o">==</span> <span class="n">out_gif</span><span class="p">:</span>
        <span class="n">tmp_gif</span> <span class="o">=</span> <span class="n">in_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;_tmp.gif&quot;</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">tmp_gif</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">tmp_gif</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">in_gif</span><span class="p">,</span> <span class="n">loglevel</span><span class="o">=</span><span class="s2">&quot;quiet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">overwrite_output</span><span class="p">()</span>
        <span class="n">ffmpeg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmp_gif</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">loglevel</span><span class="o">=</span><span class="s2">&quot;quiet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">overwrite_output</span><span class="p">()</span>
        <span class="n">ffmpeg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel1_filtering" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel1_filtering</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s1">&#39;VV&#39;</span><span class="p">,</span> <span class="n">instrumentMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orbitProperties_pass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transmitterReceiverPolarisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel1_filtering" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Sentinel-1 data is collected with several different instrument configurations, resolutions,
band combinations during both ascending and descending orbits. Because of this heterogeneity,
it's usually necessary to filter the data down to a homogeneous subset before starting processing.</p>
<p>For more details, see https://developers.google.com/earth-engine/guides/sentinel1</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection</code></td>
        <td></td>
        <td><p>A Sentinel1 ImageCollection to filter.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>str</code></td>
        <td><p>Collection band. Can be one of ['HH','HV','VV','VH']. Defaults to 'VV' which is most commonly available on land.</p></td>
        <td><code>&#39;VV&#39;</code></td>
      </tr>
      <tr>
        <td><code>instrumentMode</code></td>
        <td><code>str</code></td>
        <td><p>Collection property. Can be one of ['IW','EW','SM']. Defaults to band default availability (IW for ['VV','VH'], EW for ['HH','HV']). IW is typically available for land. EW for icy regions.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>orbitProperties_pass</code></td>
        <td><code>str|None</code></td>
        <td><p>Collection property. Can be one of ['ASCENDING', 'DESCENDING', None]. Default to 'ASCENDING'.
Will return mixed property if set to None, which dampen elevation, and increase surface roughness/fractality visibility.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>transmitterReceiverPolarisation</code></td>
        <td></td>
        <td><p>Collection property List contains this value. Can be one of ['HH','HV','VV','VH']. Defaults to band.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>remove_outliers</code></td>
        <td><code>bool</code></td>
        <td><p>Remove pixels with extreme values (&lt; -30). These can occur near the edge of an image. Default to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>All other arguments will be applied as filters to collection properties. F.e. {'resolution_meters':10}
Full list properties: https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S1_GRD#image-properties</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns a homogeneous ImageCollection of Sentinel 1 images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel1_filtering</span><span class="p">(</span>
    <span class="n">collection</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="s2">&quot;VV&quot;</span><span class="p">,</span>
    <span class="n">instrumentMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">orbitProperties_pass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transmitterReceiverPolarisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sentinel-1 data is collected with several different instrument configurations, resolutions,</span>
<span class="sd">    band combinations during both ascending and descending orbits. Because of this heterogeneity,</span>
<span class="sd">    it&#39;s usually necessary to filter the data down to a homogeneous subset before starting processing.</span>

<span class="sd">    For more details, see https://developers.google.com/earth-engine/guides/sentinel1</span>

<span class="sd">    Args:</span>
<span class="sd">        collection: A Sentinel1 ImageCollection to filter.</span>
<span class="sd">        band (str): Collection band. Can be one of [&#39;HH&#39;,&#39;HV&#39;,&#39;VV&#39;,&#39;VH&#39;]. Defaults to &#39;VV&#39; which is most commonly available on land.</span>
<span class="sd">        instrumentMode (str, optional): Collection property. Can be one of [&#39;IW&#39;,&#39;EW&#39;,&#39;SM&#39;]. Defaults to band default availability (IW for [&#39;VV&#39;,&#39;VH&#39;], EW for [&#39;HH&#39;,&#39;HV&#39;]). IW is typically available for land. EW for icy regions.</span>
<span class="sd">        orbitProperties_pass (str|None, optional): Collection property. Can be one of [&#39;ASCENDING&#39;, &#39;DESCENDING&#39;, None]. Default to &#39;ASCENDING&#39;.</span>
<span class="sd">            Will return mixed property if set to None, which dampen elevation, and increase surface roughness/fractality visibility.</span>
<span class="sd">        transmitterReceiverPolarisation: Collection property List contains this value. Can be one of [&#39;HH&#39;,&#39;HV&#39;,&#39;VV&#39;,&#39;VH&#39;]. Defaults to band.</span>
<span class="sd">        remove_outliers (bool, optional): Remove pixels with extreme values (&lt; -30). These can occur near the edge of an image. Default to True.</span>
<span class="sd">        **kwargs (dict, optional): All other arguments will be applied as filters to collection properties. F.e. {&#39;resolution_meters&#39;:10}</span>
<span class="sd">            Full list properties: https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S1_GRD#image-properties</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Returns a homogeneous ImageCollection of Sentinel 1 images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">transmitterReceiverPolarisation</span> <span class="o">=</span> <span class="n">transmitterReceiverPolarisation</span> <span class="ow">or</span> <span class="n">band</span>
    <span class="n">instrumentMode</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">instrumentMode</span> <span class="ow">or</span> <span class="p">{</span><span class="s2">&quot;VV&quot;</span><span class="p">:</span> <span class="s2">&quot;IW&quot;</span><span class="p">,</span> <span class="s2">&quot;VH&quot;</span><span class="p">:</span> <span class="s2">&quot;IW&quot;</span><span class="p">,</span> <span class="s2">&quot;HH&quot;</span><span class="p">:</span> <span class="s2">&quot;EW&quot;</span><span class="p">,</span> <span class="s2">&quot;HV&quot;</span><span class="p">:</span> <span class="s2">&quot;EW&quot;</span><span class="p">}[</span><span class="n">band</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_outliers_func</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">remove_outliers</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">image</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">band</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="o">-</span><span class="mf">30.0</span><span class="p">)</span>
        <span class="n">maskedimage</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">mask</span><span class="p">()</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">Not</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">maskedimage</span><span class="p">)</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s2">&quot;instrumentMode&quot;</span><span class="p">,</span> <span class="n">instrumentMode</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">listContains</span><span class="p">(</span>
            <span class="s2">&quot;transmitterReceiverPolarisation&quot;</span><span class="p">,</span> <span class="n">transmitterReceiverPolarisation</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">remove_outliers</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">remove_outliers_func</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">orbitProperties_pass</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s2">&quot;orbitProperties_pass&quot;</span><span class="p">,</span> <span class="n">orbitProperties_pass</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">col</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel1_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel1_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;12-31&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VV&#39;</span><span class="p">],</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorbar_width</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">colorbar_height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">colorbar_label_weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">colorbar_tick_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colorbar_bg_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">colorbar_dpi</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">colorbar_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel1_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a timelapse from any ee.ImageCollection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 2015.</p></td>
        <td><code>2015</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '01-01'.</p></td>
        <td><code>&#39;01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '12-31'.</p></td>
        <td><code>&#39;12-31&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>A list of band names to use in the timelapse. Can be one of ['VV'],['HV'],['VH'],['HH'],['VV','VH'] or ['HH','HV']</p></td>
        <td><code>[&#39;VV&#39;]</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>The frequency of the timeseries. It must be one of the following: 'year', 'month', 'day', 'hour', 'minute', 'second'. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to use to reduce the collection of images to a single value. It can be one of the following: 'median', 'mean', 'min', 'max', 'variance', 'sum'. Defaults to 'median'.</p></td>
        <td><code>&#39;median&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to 'YYYY-MM-dd'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to render a single-band image in the timelapse. Defaults to None.</p></td>
        <td><code>&#39;Greys&#39;</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system to use. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>add_colorbar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a colorbar to the timelapse. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>colorbar_width</code></td>
        <td><code>float</code></td>
        <td><p>Width of the colorbar. Defaults to 6.0.</p></td>
        <td><code>6.0</code></td>
      </tr>
      <tr>
        <td><code>colorbar_height</code></td>
        <td><code>float</code></td>
        <td><p>Height of the colorbar. Defaults to 0.4.</p></td>
        <td><code>0.4</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label</code></td>
        <td><code>str</code></td>
        <td><p>Label for the colorbar. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar label. Defaults to 12.</p></td>
        <td><code>12</code></td>
      </tr>
      <tr>
        <td><code>colorbar_label_weight</code></td>
        <td><code>str</code></td>
        <td><p>Font weight for the colorbar label. Defaults to 'normal'.</p></td>
        <td><code>&#39;normal&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_tick_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar ticks. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>colorbar_bg_color</code></td>
        <td><code>str</code></td>
        <td><p>Background color for the colorbar, can be color like "white", "black". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_orientation</code></td>
        <td><code>str</code></td>
        <td><p>Orientation of the colorbar. Defaults to 'horizontal'.</p></td>
        <td><code>&#39;horizontal&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_dpi</code></td>
        <td><code>str</code></td>
        <td><p>DPI for the colorbar, can be numbers like 100, 300. Defaults to 'figure'.</p></td>
        <td><code>&#39;figure&#39;</code></td>
      </tr>
      <tr>
        <td><code>colorbar_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the colorbar. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colorbar_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Size of the colorbar. It can be formatted like this: (300, 300). Defaults to (300, 300).</p></td>
        <td><code>(300, 300)</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create an mp4 file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Arguments for sentinel1_filtering(). Same filters will be applied to all bands.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the timelapse gif.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel1_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;VV&quot;</span><span class="p">],</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">colorbar_width</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span>
    <span class="n">colorbar_height</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">colorbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">colorbar_label_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">colorbar_tick_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">colorbar_bg_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">colorbar_dpi</span><span class="o">=</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span>
    <span class="n">colorbar_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colorbar_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a timelapse from any ee.ImageCollection.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (ee.Geometry, optional): The region to use to filter the collection of images. It must be an ee.Geometry object. Defaults to None.</span>
<span class="sd">        out_gif (str): The output gif file path. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 2015.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;01-01&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;12-31&#39;.</span>
<span class="sd">        bands (list, optional): A list of band names to use in the timelapse. Can be one of [&#39;VV&#39;],[&#39;HV&#39;],[&#39;VH&#39;],[&#39;HH&#39;],[&#39;VV&#39;,&#39;VH&#39;] or [&#39;HH&#39;,&#39;HV&#39;]</span>
<span class="sd">        frequency (str, optional): The frequency of the timeseries. It must be one of the following: &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;, &#39;minute&#39;, &#39;second&#39;. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional):  The reducer to use to reduce the collection of images to a single value. It can be one of the following: &#39;median&#39;, &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, &#39;variance&#39;, &#39;sum&#39;. Defaults to &#39;median&#39;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): A pattern, as described at http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html. Defaults to &#39;YYYY-MM-dd&#39;.</span>
<span class="sd">        palette (list, optional): A list of colors to render a single-band image in the timelapse. Defaults to None.</span>
<span class="sd">        vis_params (dict, optional): A dictionary of visualization parameters to use in the timelapse. Defaults to None. See more at https://developers.google.com/earth-engine/guides/image_visualization.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        crs (str, optional): The coordinate reference system to use. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        add_colorbar (bool, optional): Whether to add a colorbar to the timelapse. Defaults to False.</span>
<span class="sd">        colorbar_width (float, optional): Width of the colorbar. Defaults to 6.0.</span>
<span class="sd">        colorbar_height (float, optional): Height of the colorbar. Defaults to 0.4.</span>
<span class="sd">        colorbar_label (str, optional): Label for the colorbar. Defaults to None.</span>
<span class="sd">        colorbar_label_size (int, optional): Font size for the colorbar label. Defaults to 12.</span>
<span class="sd">        colorbar_label_weight (str, optional): Font weight for the colorbar label. Defaults to &#39;normal&#39;.</span>
<span class="sd">        colorbar_tick_size (int, optional): Font size for the colorbar ticks. Defaults to 10.</span>
<span class="sd">        colorbar_bg_color (str, optional): Background color for the colorbar, can be color like &quot;white&quot;, &quot;black&quot;. Defaults to None.</span>
<span class="sd">        colorbar_orientation (str, optional): Orientation of the colorbar. Defaults to &#39;horizontal&#39;.</span>
<span class="sd">        colorbar_dpi (str, optional): DPI for the colorbar, can be numbers like 100, 300. Defaults to &#39;figure&#39;.</span>
<span class="sd">        colorbar_xy (tuple, optional): Lower left corner of the colorbar. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        colorbar_size (tuple, optional): Size of the colorbar. It can be formatted like this: (300, 300). Defaults to (300, 300).</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to create an mp4 file. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>
<span class="sd">        **kwargs: Arguments for sentinel1_filtering(). Same filters will be applied to all bands.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the timelapse gif.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

    <span class="k">assert</span> <span class="n">bands</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;VV&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;VH&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;HH&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;HV&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;VV&quot;</span><span class="p">,</span> <span class="s2">&quot;VH&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;HH&quot;</span><span class="p">,</span> <span class="s2">&quot;HV&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;VH&quot;</span><span class="p">,</span> <span class="s2">&quot;VV&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;HV&quot;</span><span class="p">,</span> <span class="s2">&quot;HH&quot;</span><span class="p">],</span>
    <span class="p">),</span> <span class="s2">&quot;Not all Sentinel1 bands are available together.&quot;</span>
    <span class="k">if</span> <span class="n">bands</span> <span class="ow">in</span> <span class="p">([</span><span class="s2">&quot;VH&quot;</span><span class="p">,</span> <span class="s2">&quot;VV&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;HV&quot;</span><span class="p">,</span> <span class="s2">&quot;HH&quot;</span><span class="p">]):</span>
        <span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bands</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">band</span> <span class="o">=</span> <span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

    <span class="n">start</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">end</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

    <span class="n">collection</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S1_GRD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">sentinel1_filtering</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">create_timelapse</span><span class="p">(</span>
        <span class="n">collection</span><span class="p">,</span>
        <span class="n">start</span><span class="p">,</span>
        <span class="n">end</span><span class="p">,</span>
        <span class="n">roi</span><span class="p">,</span>
        <span class="n">bands</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">,</span>
        <span class="n">reducer</span><span class="p">,</span>
        <span class="n">date_format</span><span class="p">,</span>
        <span class="n">out_gif</span><span class="p">,</span>
        <span class="n">palette</span><span class="p">,</span>
        <span class="n">vis_params</span><span class="p">,</span>
        <span class="n">dimensions</span><span class="p">,</span>
        <span class="n">frames_per_second</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">,</span>
        <span class="n">overlay_data</span><span class="p">,</span>
        <span class="n">overlay_color</span><span class="p">,</span>
        <span class="n">overlay_width</span><span class="p">,</span>
        <span class="n">overlay_opacity</span><span class="p">,</span>
        <span class="n">title</span><span class="p">,</span>
        <span class="n">title_xy</span><span class="p">,</span>
        <span class="n">add_text</span><span class="p">,</span>
        <span class="n">text_xy</span><span class="p">,</span>
        <span class="n">text_sequence</span><span class="p">,</span>
        <span class="n">font_type</span><span class="p">,</span>
        <span class="n">font_size</span><span class="p">,</span>
        <span class="n">font_color</span><span class="p">,</span>
        <span class="n">add_progress_bar</span><span class="p">,</span>
        <span class="n">progress_bar_color</span><span class="p">,</span>
        <span class="n">progress_bar_height</span><span class="p">,</span>
        <span class="n">add_colorbar</span><span class="p">,</span>
        <span class="n">colorbar_width</span><span class="p">,</span>
        <span class="n">colorbar_height</span><span class="p">,</span>
        <span class="n">colorbar_label</span><span class="p">,</span>
        <span class="n">colorbar_label_size</span><span class="p">,</span>
        <span class="n">colorbar_label_weight</span><span class="p">,</span>
        <span class="n">colorbar_tick_size</span><span class="p">,</span>
        <span class="n">colorbar_bg_color</span><span class="p">,</span>
        <span class="n">colorbar_orientation</span><span class="p">,</span>
        <span class="n">colorbar_dpi</span><span class="p">,</span>
        <span class="n">colorbar_xy</span><span class="p">,</span>
        <span class="n">colorbar_size</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">,</span>
        <span class="n">mp4</span><span class="p">,</span>
        <span class="n">fading</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel1_timelapse_legacy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel1_timelapse_legacy</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;12-31&#39;</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel1_timelapse_legacy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a Sentinel-1 timelapse animated GIF or MP4.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to LV &amp; Lake Mead.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output animated GIF. Defaults to the Downloads folder s1_ts_*.gif.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 2015.</p></td>
        <td><code>2015</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '01-01'.</p></td>
        <td><code>&#39;01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '12-31'.</p></td>
        <td><code>&#39;12-31&#39;</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>Visualization parameters. Defaults to {'min':-18, 'max': -4}.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>Coordinate reference system. Defaults to 'EPSG:3857'.</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Line width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'. Can be year, quarter or month.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to image start dates.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the GIF to MP4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the output GIF image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel1_timelapse_legacy</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31&quot;</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a Sentinel-1 timelapse animated GIF or MP4.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to LV &amp; Lake Mead.</span>
<span class="sd">        out_gif (str, optional): File path to the output animated GIF. Defaults to the Downloads folder s1_ts_*.gif.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 2015.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;01-01&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;12-31&#39;.</span>
<span class="sd">        vis_params (dict, optional): Visualization parameters. Defaults to {&#39;min&#39;:-18, &#39;max&#39;: -4}.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 5.</span>
<span class="sd">        crs (str, optional): Coordinate reference system. Defaults to &#39;EPSG:3857&#39;.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Line width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;. Can be year, quarter or month.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to image start dates.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;white&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the GIF to MP4. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the output GIF image.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CURRENT_YEAR</span><span class="p">,</span> <span class="n">ROI_DEFAULT</span> <span class="o">=</span> <span class="n">sentinel1_defaults</span><span class="p">()</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span> <span class="ow">or</span> <span class="n">ROI_DEFAULT</span>
    <span class="n">end_year</span> <span class="o">=</span> <span class="n">end_year</span> <span class="ow">or</span> <span class="n">CURRENT_YEAR</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">sentinel1_timeseries</span><span class="p">(</span>
        <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span>
        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
        <span class="n">end_year</span><span class="o">=</span><span class="n">end_year</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">vis_params</span> <span class="o">=</span> <span class="n">vis_params</span> <span class="ow">or</span> <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;Downloads&quot;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;s1_ts_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.gif&quot;</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The output file must end with .gif&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
            <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">dimensions</span> <span class="o">&gt;</span> <span class="mi">768</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">dim</span> <span class="o">&gt;</span> <span class="mi">768</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))))</span>
    <span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">out_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))))</span><span class="si">}</span><span class="s2">.jpg&quot;</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">get_image_collection_thumbnails</span><span class="p">(</span>
            <span class="n">col</span><span class="p">,</span>
            <span class="n">out_dir</span><span class="p">,</span>
            <span class="n">vis_params</span><span class="o">=</span><span class="n">vis_params</span><span class="p">,</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">make_gif</span><span class="p">(</span>
            <span class="n">names</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">fps</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">clean_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">video_args</span> <span class="o">=</span> <span class="n">vis_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dimensions</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roi</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;framesPerSecond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frames_per_second</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span>
        <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span>

        <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">video_args</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">add_text_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="n">title_xy</span><span class="p">,</span>
                <span class="n">text_sequence</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
            <span class="n">add_text_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span>
                <span class="n">text_sequence</span><span class="o">=</span><span class="n">text_sequence</span><span class="p">,</span>
                <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out_gif</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel1_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel1_timeseries</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;12-31&#39;</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s1">&#39;VV&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel1_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>Generates a Sentinel 1 ImageCollection,
based on mean composites following a steady frequency (f.e. 1 image per month)
</code></pre></div></td></tr></table></div>
<p>Adapted from https://code.earthengine.google.com/?scriptPath=Examples:Datasets/COPERNICUS_S1_GRD</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to a polygon partially covering Las Vegas and Lake Mead.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 2015.</p></td>
        <td><code>2015</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '01-01'.</p></td>
        <td><code>&#39;01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '12-31'.</p></td>
        <td><code>&#39;12-31&#39;</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.  Can be 'year', 'quarter' or 'month'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>str</code></td>
        <td><p>Collection band. Can be one of ['HH','HV','VV','VH']. Defaults to 'VV' which is most commonly available on land.</p></td>
        <td><code>&#39;VV&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Arguments for sentinel1_filtering().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns an ImageCollection of Sentinel 1 images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel1_timeseries</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="s2">&quot;VV&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Sentinel 1 ImageCollection,</span>
<span class="sd">        based on mean composites following a steady frequency (f.e. 1 image per month)</span>
<span class="sd">    Adapted from https://code.earthengine.google.com/?scriptPath=Examples:Datasets/COPERNICUS_S1_GRD</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to a polygon partially covering Las Vegas and Lake Mead.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 2015.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;01-01&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;12-31&#39;.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.  Can be &#39;year&#39;, &#39;quarter&#39; or &#39;month&#39;.</span>
<span class="sd">        band (str): Collection band. Can be one of [&#39;HH&#39;,&#39;HV&#39;,&#39;VV&#39;,&#39;VH&#39;]. Defaults to &#39;VV&#39; which is most commonly available on land.</span>
<span class="sd">        **kwargs: Arguments for sentinel1_filtering().</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Returns an ImageCollection of Sentinel 1 images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CURRENT_YEAR</span><span class="p">,</span> <span class="n">ROI_DEFAULT</span> <span class="o">=</span> <span class="n">sentinel1_defaults</span><span class="p">()</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span> <span class="ow">or</span> <span class="n">ROI_DEFAULT</span>
    <span class="n">end_year</span> <span class="o">=</span> <span class="n">end_year</span> <span class="ow">or</span> <span class="n">CURRENT_YEAR</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">valid_roi</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">end</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">dates</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S1_GRD&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">sentinel1_filtering</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">band</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="s2">&quot;month&quot;</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>  <span class="c1"># coll, frequency</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">date</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">col</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                    <span class="s2">&quot;system:time_end&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                    <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">imgList</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">date</span><span class="p">:</span> <span class="n">transform</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
    <span class="n">imgColl</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">imgList</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
        <span class="n">imgColl</span> <span class="o">=</span> <span class="n">imgColl</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">imgColl</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel2_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel2_timelapse</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;06-10&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;09-20&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NIR&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cloud_pct</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;90%&#39;</span><span class="p">),</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2%&#39;</span><span class="p">,</span> <span class="s1">&#39;2%&#39;</span><span class="p">),</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel2_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a Sentinel-2 timelapse GIF image. This function is adapted from https://emaprlab.users.earthengine.app/view/lt-gee-time-series-animator. A huge thank you to Justin Braaten for sharing his fantastic work.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output animated GIF. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 2015.</p></td>
        <td><code>2015</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which means the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '06-10'.</p></td>
        <td><code>&#39;06-10&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '09-20'.</p></td>
        <td><code>&#39;09-20&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>Three bands selected from ['Blue', 'Green', 'Red', 'NIR', 'SWIR1', 'SWIR2', 'Red Edge 1', 'Red Edge 2', 'Red Edge 3', 'Red Edge 4']. Defaults to ['NIR', 'Red', 'Green'].</p></td>
        <td><code>[&#39;NIR&#39;, &#39;Red&#39;, &#39;Green&#39;]</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>Visualization parameters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dimensions</code></td>
        <td><code>int</code></td>
        <td><p>a number or pair of numbers (in format 'WIDTHxHEIGHT') Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</p></td>
        <td><code>768</code></td>
      </tr>
      <tr>
        <td><code>frames_per_second</code></td>
        <td><code>int</code></td>
        <td><p>Animation speed. Defaults to 10.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>Coordinate reference system. Defaults to 'EPSG:3857'.</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>apply_fmask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>cloud_pct</code></td>
        <td><code>int</code></td>
        <td><p>Maximum percentage of cloud coverage allowed. Defaults to 30.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>overlay_data</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Administrative boundary to be drawn on the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overlay_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the overlay data. Can be any color name or hex color code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>overlay_width</code></td>
        <td><code>int</code></td>
        <td><p>Line width of the overlay. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>overlay_opacity</code></td>
        <td><code>float</code></td>
        <td><p>Opacity of the overlay. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Date format for the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the title. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add animated text to the timelapse. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>title_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Lower left corner of the text sequency. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>(&#39;2%&#39;, &#39;90%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the GIF to MP4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fading</code></td>
        <td><code>int | bool</code></td>
        <td><p>If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>Step size for selecting images. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>Additional arguments to pass the geemap.create_timeseries() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>File path to the output GIF image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel2_timelapse</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;06-10&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;09-20&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">],</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span>
    <span class="n">frames_per_second</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cloud_pct</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">overlay_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">overlay_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;90%&quot;</span><span class="p">),</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2%&quot;</span><span class="p">,</span> <span class="s2">&quot;2%&quot;</span><span class="p">),</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a Sentinel-2 timelapse GIF image. This function is adapted from https://emaprlab.users.earthengine.app/view/lt-gee-time-series-animator. A huge thank you to Justin Braaten for sharing his fantastic work.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        out_gif (str, optional): File path to the output animated GIF. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 2015.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which means the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;06-10&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;09-20&#39;.</span>
<span class="sd">        bands (list, optional): Three bands selected from [&#39;Blue&#39;, &#39;Green&#39;, &#39;Red&#39;, &#39;NIR&#39;, &#39;SWIR1&#39;, &#39;SWIR2&#39;, &#39;Red Edge 1&#39;, &#39;Red Edge 2&#39;, &#39;Red Edge 3&#39;, &#39;Red Edge 4&#39;]. Defaults to [&#39;NIR&#39;, &#39;Red&#39;, &#39;Green&#39;].</span>
<span class="sd">        vis_params (dict, optional): Visualization parameters. Defaults to None.</span>
<span class="sd">        dimensions (int, optional): a number or pair of numbers (in format &#39;WIDTHxHEIGHT&#39;) Maximum dimensions of the thumbnail to render, in pixels. If only one number is passed, it is used as the maximum, and the other dimension is computed by proportional scaling. Defaults to 768.</span>
<span class="sd">        frames_per_second (int, optional): Animation speed. Defaults to 10.</span>
<span class="sd">        crs (str, optional): Coordinate reference system. Defaults to &#39;EPSG:3857&#39;.</span>
<span class="sd">        apply_fmask (bool, optional): Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</span>
<span class="sd">        cloud_pct (int, optional): Maximum percentage of cloud coverage allowed. Defaults to 30.</span>
<span class="sd">        overlay_data (int, str, list, optional): Administrative boundary to be drawn on the timelapse. Defaults to None.</span>
<span class="sd">        overlay_color (str, optional): Color for the overlay data. Can be any color name or hex color code. Defaults to &#39;black&#39;.</span>
<span class="sd">        overlay_width (int, optional): Line width of the overlay. Defaults to 1.</span>
<span class="sd">        overlay_opacity (float, optional): Opacity of the overlay. Defaults to 1.0.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        date_format (str, optional): Date format for the timelapse. Defaults to None.</span>
<span class="sd">        title (str, optional): The title of the timelapse. Defaults to None.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the title. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add animated text to the timelapse. Defaults to True.</span>
<span class="sd">        title_xy (tuple, optional): Lower left corner of the text sequency. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        loop (int, optional): Controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the GIF to MP4. Defaults to False.</span>
<span class="sd">        fading (int | bool, optional): If True, add fading effect to the timelapse. Defaults to False, no fading. To add fading effect, set it to True (1 second fading duration) or to an integer value (fading duration).</span>
<span class="sd">        step (int, optional): Step size for selecting images. Defaults to 1.</span>
<span class="sd">        kwargs (optional): Additional arguments to pass the geemap.create_timeseries() function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File path to the output GIF image.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Feature</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">):</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided roi is invalid. It must be an ee.Geometry&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;Downloads&quot;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;s2_ts_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.gif&quot;</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The output file must end with .gif&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">allowed_bands</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Blue&quot;</span><span class="p">:</span> <span class="s2">&quot;B2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Green&quot;</span><span class="p">:</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Red&quot;</span><span class="p">:</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Red Edge 1&quot;</span><span class="p">:</span> <span class="s2">&quot;B5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Red Edge 2&quot;</span><span class="p">:</span> <span class="s2">&quot;B6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Red Edge 3&quot;</span><span class="p">:</span> <span class="s2">&quot;B7&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NIR&quot;</span><span class="p">:</span> <span class="s2">&quot;B8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Red Edge 4&quot;</span><span class="p">:</span> <span class="s2">&quot;B8A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SWIR1&quot;</span><span class="p">:</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SWIR2&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span>
        <span class="s2">&quot;QA60&quot;</span><span class="p">:</span> <span class="s2">&quot;QA60&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span> <span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">band</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bands</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">allowed_bands</span><span class="p">:</span>
            <span class="n">bands</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">allowed_bands</span><span class="p">[</span><span class="n">band</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;You can only select 3 bands from the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_bands</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bands</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span>
            <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;reducer&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reducer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;median&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;drop_empty&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;drop_empty&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s2">&quot;parallel_scale&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;parallel_scale&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;date_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_format</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">sentinel2_timeseries</span><span class="p">(</span>
            <span class="n">roi</span><span class="p">,</span>
            <span class="n">start_year</span><span class="p">,</span>
            <span class="n">end_year</span><span class="p">,</span>
            <span class="n">start_date</span><span class="p">,</span>
            <span class="n">end_date</span><span class="p">,</span>
            <span class="n">bands</span><span class="p">,</span>
            <span class="n">apply_fmask</span><span class="p">,</span>
            <span class="n">cloud_pct</span><span class="p">,</span>
            <span class="n">frequency</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">vis_params</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">overlay_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">add_overlay</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span> <span class="n">overlay_data</span><span class="p">,</span> <span class="n">overlay_color</span><span class="p">,</span> <span class="n">overlay_width</span><span class="p">,</span> <span class="n">overlay_opacity</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">dimensions</span> <span class="o">&gt;</span> <span class="mi">768</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">dim</span> <span class="o">&gt;</span> <span class="mi">768</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))))</span>
        <span class="p">):</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">out_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))))</span><span class="si">}</span><span class="s2">.jpg&quot;</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">get_image_collection_thumbnails</span><span class="p">(</span>
                <span class="n">col</span><span class="p">,</span>
                <span class="n">out_dir</span><span class="p">,</span>
                <span class="n">vis_params</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                    <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">],</span>
                <span class="p">},</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">make_gif</span><span class="p">(</span>
                <span class="n">names</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">fps</span><span class="o">=</span><span class="n">frames_per_second</span><span class="p">,</span>
                <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">clean_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">video_args</span> <span class="o">=</span> <span class="n">vis_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dimensions</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roi</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;framesPerSecond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frames_per_second</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vis-red&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-green&quot;</span><span class="p">,</span> <span class="s2">&quot;vis-blue&quot;</span><span class="p">]</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">video_args</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>

            <span class="n">download_ee_video</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">video_args</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">add_text_to_gif</span><span class="p">(</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="n">title_xy</span><span class="p">,</span>
                    <span class="n">text_sequence</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                    <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                    <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                    <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                    <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">text_sequence</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
                <span class="n">add_text_to_gif</span><span class="p">(</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">out_gif</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="n">text_xy</span><span class="p">,</span>
                    <span class="n">text_sequence</span><span class="o">=</span><span class="n">text_sequence</span><span class="p">,</span>
                    <span class="n">font_type</span><span class="o">=</span><span class="n">font_type</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                    <span class="n">font_color</span><span class="o">=</span><span class="n">font_color</span><span class="p">,</span>
                    <span class="n">add_progress_bar</span><span class="o">=</span><span class="n">add_progress_bar</span><span class="p">,</span>
                    <span class="n">progress_bar_color</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">,</span>
                    <span class="n">progress_bar_height</span><span class="o">=</span><span class="n">progress_bar_height</span><span class="p">,</span>
                    <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">frames_per_second</span><span class="p">,</span>
                    <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fading</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">fading</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fading</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fading</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gif_fading</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">fading</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_gif</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel2_timeseries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel2_timeseries</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;12-31&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cloud_pct</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel2_timeseries" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates an annual Sentinel 2 ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.
   Images include both level 1C and level 2A imagery.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 2015.</p></td>
        <td><code>2015</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which will use the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '01-01'.</p></td>
        <td><code>&#39;01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>mask_cloud</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to mask clouds. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '12-31'.</p></td>
        <td><code>&#39;12-31&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The list of bands to use to create the timeseries. It must be a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>cloud_pct</code></td>
        <td><code>int</code></td>
        <td><p>Maximum cloud percentage to include in the timelapse. Defaults to 30.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str</code></td>
        <td><p>The reducer to use to reduce the collection of images to a single value. It can be one of the following: 'median', 'mean', 'min', 'max', 'variance', 'sum'. Defaults to 'median'.</p></td>
        <td><code>&#39;median&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_empty</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop empty images from the timeseries. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Format of the date. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>parallel_scale</code></td>
        <td><code>int</code></td>
        <td><p>A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>int</code></td>
        <td><p>The step size to use when creating the date sequence. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns an ImageCollection containing annual Sentinel 2 images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel2_timeseries</span><span class="p">(</span>
    <span class="n">roi</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mask_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cloud_pct</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">,</span>
    <span class="n">drop_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">parallel_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an annual Sentinel 2 ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.</span>
<span class="sd">       Images include both level 1C and level 2A imagery.</span>
<span class="sd">    Args:</span>

<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 2015.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which will use the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;01-01&#39;.</span>
<span class="sd">        mask_cloud (bool, optional): Whether to mask clouds. Defaults to True.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;12-31&#39;.</span>
<span class="sd">        bands (list, optional): The list of bands to use to create the timeseries. It must be a list of strings. Defaults to None.</span>
<span class="sd">        cloud_pct (int, optional): Maximum cloud percentage to include in the timelapse. Defaults to 30.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        reducer (str, optional):  The reducer to use to reduce the collection of images to a single value. It can be one of the following: &#39;median&#39;, &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, &#39;variance&#39;, &#39;sum&#39;. Defaults to &#39;median&#39;.</span>
<span class="sd">        drop_empty (bool, optional): Whether to drop empty images from the timeseries. Defaults to True.</span>
<span class="sd">        date_format (str, optional): Format of the date. Defaults to None.</span>
<span class="sd">        parallel_scale (int, optional): A scaling factor used to limit memory use; using a larger parallel_scale (e.g. 2 or 4) may enable computations that run out of memory with the default. Defaults to 1.</span>
<span class="sd">        step (int, optional): The step size to use when creating the date sequence. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Returns an ImageCollection containing annual Sentinel 2 images.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

    <span class="k">def</span> <span class="nf">maskS2clouds</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
        <span class="n">qa</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA60&quot;</span><span class="p">)</span>

        <span class="c1"># Bits 10 and 11 are clouds and cirrus, respectively.</span>
        <span class="n">cloudBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span>
        <span class="n">cirrusBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span>

        <span class="c1"># Both flags should be set to zero, indicating clear conditions.</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudBitMask</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cirrusBitMask</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">image</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
            <span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">toDictionary</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span>
        <span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">end</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">doy_start</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">))</span>
    <span class="n">doy_end</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">))</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S2_HARMONIZED&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">calendarRange</span><span class="p">(</span><span class="n">doy_start</span><span class="p">,</span> <span class="n">doy_end</span><span class="p">,</span> <span class="s2">&quot;day_of_year&quot;</span><span class="p">))</span>
        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="s2">&quot;CLOUDY_PIXEL_PERCENTAGE&quot;</span><span class="p">,</span> <span class="n">cloud_pct</span><span class="p">))</span>
        <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mask_cloud</span><span class="p">:</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">maskS2clouds</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">toDictionary</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">allowed_bands</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Blue&quot;</span><span class="p">:</span> <span class="s2">&quot;B2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Green&quot;</span><span class="p">:</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red&quot;</span><span class="p">:</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 1&quot;</span><span class="p">:</span> <span class="s2">&quot;B5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 2&quot;</span><span class="p">:</span> <span class="s2">&quot;B6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 3&quot;</span><span class="p">:</span> <span class="s2">&quot;B7&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NIR&quot;</span><span class="p">:</span> <span class="s2">&quot;B8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 4&quot;</span><span class="p">:</span> <span class="s2">&quot;B8A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SWIR1&quot;</span><span class="p">:</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SWIR2&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;QA60&quot;</span><span class="p">:</span> <span class="s2">&quot;QA60&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">band</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bands</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">allowed_bands</span><span class="p">:</span>
                <span class="n">bands</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">allowed_bands</span><span class="p">[</span><span class="n">band</span><span class="p">]</span>

        <span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">create_timeseries</span><span class="p">(</span>
        <span class="n">collection</span><span class="p">,</span>
        <span class="n">start</span><span class="p">,</span>
        <span class="n">end</span><span class="p">,</span>
        <span class="n">roi</span><span class="p">,</span>
        <span class="n">bands</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">,</span>
        <span class="n">reducer</span><span class="p">,</span>
        <span class="n">drop_empty</span><span class="p">,</span>
        <span class="n">date_format</span><span class="p">,</span>
        <span class="n">parallel_scale</span><span class="p">,</span>
        <span class="n">step</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ts</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.sentinel2_timeseries_legacy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sentinel2_timeseries_legacy</span><span class="p">(</span><span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;12-31&#39;</span><span class="p">,</span> <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.timelapse.sentinel2_timeseries_legacy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates an annual Sentinel 2 ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.
   Images include both level 1C and level 2A imagery.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td><code>object</code></td>
        <td><p>Region of interest to create the timelapse. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_year</code></td>
        <td><code>int</code></td>
        <td><p>Starting year for the timelapse. Defaults to 2015.</p></td>
        <td><code>2015</code></td>
      </tr>
      <tr>
        <td><code>end_year</code></td>
        <td><code>int</code></td>
        <td><p>Ending year for the timelapse. Defaults to None, which will use the current year.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Starting date (month-day) each year for filtering ImageCollection. Defaults to '01-01'.</p></td>
        <td><code>&#39;01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>Ending date (month-day) each year for filtering ImageCollection. Defaults to '12-31'.</p></td>
        <td><code>&#39;12-31&#39;</code></td>
      </tr>
      <tr>
        <td><code>apply_fmask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>frequency</code></td>
        <td><code>str</code></td>
        <td><p>Frequency of the timelapse. Defaults to 'year'.</p></td>
        <td><code>&#39;year&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Format of the date. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Returns an ImageCollection containing annual Sentinel 2 images.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sentinel2_timeseries_legacy</span><span class="p">(</span>
    <span class="n">roi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31&quot;</span><span class="p">,</span>
    <span class="n">apply_fmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an annual Sentinel 2 ImageCollection. This algorithm is adapted from https://gist.github.com/jdbcode/76b9ac49faf51627ebd3ff988e10adbc. A huge thank you to Justin Braaten for sharing his fantastic work.</span>
<span class="sd">       Images include both level 1C and level 2A imagery.</span>
<span class="sd">    Args:</span>

<span class="sd">        roi (object, optional): Region of interest to create the timelapse. Defaults to None.</span>
<span class="sd">        start_year (int, optional): Starting year for the timelapse. Defaults to 2015.</span>
<span class="sd">        end_year (int, optional): Ending year for the timelapse. Defaults to None, which will use the current year.</span>
<span class="sd">        start_date (str, optional): Starting date (month-day) each year for filtering ImageCollection. Defaults to &#39;01-01&#39;.</span>
<span class="sd">        end_date (str, optional): Ending date (month-day) each year for filtering ImageCollection. Defaults to &#39;12-31&#39;.</span>
<span class="sd">        apply_fmask (bool, optional): Whether to apply Fmask (Function of mask) for automated clouds, cloud shadows, snow, and water masking.</span>
<span class="sd">        frequency (str, optional): Frequency of the timelapse. Defaults to &#39;year&#39;.</span>
<span class="sd">        date_format (str, optional): Format of the date. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Returns an ImageCollection containing annual Sentinel 2 images.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">################################################################################</span>

    <span class="c1">################################################################################</span>
    <span class="c1"># Input and output parameters.</span>

    <span class="kn">import</span> <span class="nn">re</span>

    <span class="c1"># import datetime</span>

    <span class="k">if</span> <span class="n">end_year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

    <span class="k">if</span> <span class="n">roi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># roi = ee.Geometry.Polygon(</span>
        <span class="c1">#     [[[-180, -80],</span>
        <span class="c1">#       [-180, 80],</span>
        <span class="c1">#         [180, 80],</span>
        <span class="c1">#         [180, -80],</span>
        <span class="c1">#         [-180, -80]]], None, False)</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">36.409454</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">114.271283</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">115.471773</span><span class="p">,</span> <span class="mf">35.892718</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not convert the provided roi to ee.Geometry&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="c1"># Adjusts longitudes less than -180 degrees or greater than 180 degrees.</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">ee_to_geojson</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">adjust_longitude</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>

    <span class="n">feq_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quarter&quot;</span><span class="p">:</span> <span class="s2">&quot;YYYY-MM&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">date_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date_format</span> <span class="o">=</span> <span class="n">feq_dict</span><span class="p">[</span><span class="n">frequency</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">feq_dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;frequency must be year, quarter, or month.&quot;</span><span class="p">)</span>

    <span class="c1">################################################################################</span>
    <span class="c1"># Setup vars to get dates.</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">start_year</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">start_year</span> <span class="o">&lt;=</span> <span class="n">get_current_year</span><span class="p">())</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The start year must be an integer &gt;= 2015.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">end_year</span> <span class="o">&gt;=</span> <span class="mi">2015</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">end_year</span> <span class="o">&lt;=</span> <span class="n">get_current_year</span><span class="p">())</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The end year must be an integer &lt;= </span><span class="si">{</span><span class="n">get_current_year</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[0-9]</span><span class="si">{2}</span><span class="s2">-[0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;[0-9]</span><span class="si">{2}</span><span class="s2">-[0-9]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end_date</span>
    <span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The start data and end date must be month-day, such as 06-10, 09-20&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">end_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input dates are invalid.&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">start_test</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">start_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="n">end_test</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">end_year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">start_test</span> <span class="o">&gt;</span> <span class="n">end_test</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Start date must be prior to end date&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">days_between</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">d2</span> <span class="o">-</span> <span class="n">d1</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>

    <span class="n">n_days</span> <span class="o">=</span> <span class="n">days_between</span><span class="p">(</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">start_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">end_date</span>
    <span class="p">)</span>
    <span class="n">start_month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_date</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="c1"># start_date = str(start_year) + &quot;-&quot; + start_date</span>
    <span class="c1"># end_date = str(end_year) + &quot;-&quot; + end_date</span>

    <span class="c1"># # Define a collection filter by date, bounds, and quality.</span>
    <span class="c1"># def colFilter(col, aoi):  # , startDate, endDate):</span>
    <span class="c1">#     return(col.filterBounds(aoi))</span>

    <span class="c1"># Get Sentinel 2 collections, both Level-1C (top of atmophere) and Level-2A (surface reflectance)</span>
    <span class="n">MSILCcol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S2&quot;</span><span class="p">)</span>
    <span class="n">MSI2Acol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S2_SR&quot;</span><span class="p">)</span>

    <span class="c1"># Define a collection filter by date, bounds, and quality.</span>
    <span class="k">def</span> <span class="nf">colFilter</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">col</span><span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
        <span class="c1"># .filter(&#39;CLOUD_COVER &lt; 5&#39;)</span>
        <span class="c1"># .filter(&#39;GEOMETRIC_RMSE_MODEL &lt; 15&#39;)</span>
        <span class="c1"># .filter(&#39;IMAGE_QUALITY == 9 || IMAGE_QUALITY_OLI == 9&#39;))</span>

    <span class="c1"># Function to get and rename bands of interest from MSI</span>
    <span class="k">def</span> <span class="nf">renameMSI</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B5&quot;</span><span class="p">,</span> <span class="s2">&quot;B6&quot;</span><span class="p">,</span> <span class="s2">&quot;B7&quot;</span><span class="p">,</span> <span class="s2">&quot;B8&quot;</span><span class="p">,</span> <span class="s2">&quot;B8A&quot;</span><span class="p">,</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span> <span class="s2">&quot;QA60&quot;</span><span class="p">],</span>
            <span class="p">[</span>
                <span class="s2">&quot;Blue&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Red&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Red Edge 1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Red Edge 2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Red Edge 3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIR&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Red Edge 4&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;QA60&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># Add NBR for LandTrendr segmentation.</span>

    <span class="k">def</span> <span class="nf">calcNbr</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">([</span><span class="s2">&quot;NIR&quot;</span><span class="p">,</span> <span class="s2">&quot;SWIR2&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;NBR&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">int16</span><span class="p">()</span>

    <span class="c1"># Define function to mask out clouds and cloud shadows in images.</span>
    <span class="c1"># Use CFmask band included in USGS Landsat SR image product.</span>

    <span class="k">def</span> <span class="nf">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">cloudOpaqueBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span>
        <span class="n">cloudCirrusBitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span>
        <span class="n">qa</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA60&quot;</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudOpaqueBitMask</span><span class="p">)</span>
            <span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qa</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">cloudCirrusBitMask</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

    <span class="c1"># Define function to prepare MSI images.</span>
    <span class="k">def</span> <span class="nf">prepMSI</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">img</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">renameMSI</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">apply_fmask</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">fmask</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">copyProperties</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">orig</span><span class="o">.</span><span class="n">propertyNames</span><span class="p">()))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
            <span class="s2">&quot;bicubic&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get annual median collection.</span>
    <span class="k">def</span> <span class="nf">getAnnualComp</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">fromYMD</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">start_month</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">start_day</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">n_days</span><span class="p">),</span> <span class="s2">&quot;day&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">MSILCcoly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">MSILCcol</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepMSI</span><span class="p">)</span>
        <span class="n">MSI2Acoly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">MSI2Acol</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepMSI</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">MSILCcoly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">MSI2Acoly</span><span class="p">)</span>

        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">yearImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">yearImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calcNbr</span><span class="p">(</span><span class="n">yearImg</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Get quarterly median collection.</span>
    <span class="k">def</span> <span class="nf">getQuarterlyComp</span><span class="p">(</span><span class="n">startDate</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">MSILCcoly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">MSILCcol</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepMSI</span><span class="p">)</span>
        <span class="n">MSI2Acoly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">MSI2Acol</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepMSI</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">MSILCcoly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">MSI2Acoly</span><span class="p">)</span>

        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">yearImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">yearImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calcNbr</span><span class="p">(</span><span class="n">yearImg</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># Get monthly median collection.</span>
    <span class="k">def</span> <span class="nf">getMonthlyComp</span><span class="p">(</span><span class="n">startDate</span><span class="p">):</span>
        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span>
        <span class="n">endDate</span> <span class="o">=</span> <span class="n">startDate</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>

        <span class="c1"># Filter collections and prepare them for merging.</span>
        <span class="n">MSILCcoly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">MSILCcol</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepMSI</span><span class="p">)</span>
        <span class="n">MSI2Acoly</span> <span class="o">=</span> <span class="n">colFilter</span><span class="p">(</span><span class="n">MSI2Acol</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepMSI</span><span class="p">)</span>

        <span class="c1"># Merge the collections.</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">MSILCcoly</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">MSI2Acoly</span><span class="p">)</span>

        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="n">nBands</span> <span class="o">=</span> <span class="n">yearImg</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">yearImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">nBands</span><span class="p">,</span> <span class="n">yearImg</span><span class="p">,</span> <span class="n">dummyImg</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">calcNbr</span><span class="p">(</span><span class="n">yearImg</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;system:time_start&quot;</span><span class="p">:</span> <span class="n">startDate</span><span class="o">.</span><span class="n">millis</span><span class="p">(),</span>
                <span class="s2">&quot;nBands&quot;</span><span class="p">:</span> <span class="n">nBands</span><span class="p">,</span>
                <span class="s2">&quot;system:date&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1">################################################################################</span>

    <span class="c1"># Make a dummy image for missing years.</span>
    <span class="n">bandNames</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">&quot;Blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NIR&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red Edge 4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SWIR1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SWIR2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;QA60&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">fillerValues</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bandNames</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
    <span class="n">dummyImg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">fillerValues</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">bandNames</span><span class="p">)</span><span class="o">.</span><span class="n">selfMask</span><span class="p">()</span><span class="o">.</span><span class="n">int16</span><span class="p">()</span>

    <span class="c1"># ################################################################################</span>
    <span class="c1"># # Get a list of years</span>
    <span class="c1"># years = ee.List.sequence(start_year, end_year)</span>

    <span class="c1"># ################################################################################</span>
    <span class="c1"># # Make list of annual image composites.</span>
    <span class="c1"># imgList = years.map(getAnnualComp)</span>

    <span class="k">if</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span>
        <span class="n">years</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">years</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getAnnualComp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;quarter&quot;</span><span class="p">:</span>
        <span class="n">quarters</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span><span class="p">,</span> <span class="s2">&quot;quarter&quot;</span><span class="p">,</span> <span class="n">date_format</span>
        <span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">quarters</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getQuarterlyComp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frequency</span> <span class="o">==</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">date_sequence</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-12-31&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">date_format</span>
        <span class="p">)</span>
        <span class="n">imgList</span> <span class="o">=</span> <span class="n">months</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">getMonthlyComp</span><span class="p">)</span>

    <span class="c1"># Convert image composite list to collection</span>
    <span class="n">imgCol</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">imgList</span><span class="p">)</span>

    <span class="n">imgCol</span> <span class="o">=</span> <span class="n">imgCol</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">imgCol</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="geemap.timelapse.vector_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_gif</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">colname</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1%&#39;</span><span class="p">,</span> <span class="s1">&#39;1%&#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_png</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">plot_args</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#geemap.timelapse.vector_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a vector to a gif. This function was inspired by by Johannes Uhl's shapefile2gif repo at
        https://github.com/johannesuhl/shapefile2gif. Credits to Johannes Uhl.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The input vector file. Can be a directory path or http URL, e.g., "https://i.imgur.com/ZWSZC5z.gif"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>colname</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the vector that contains numerical values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to filter the data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to filter the data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>float</code></td>
        <td><p>The step to filter the data. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>facecolor</code></td>
        <td><code>str</code></td>
        <td><p>The color to visualize the data. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>The figure size. Defaults to (10, 8).</p></td>
        <td><code>(10, 8)</code></td>
      </tr>
      <tr>
        <td><code>padding</code></td>
        <td><code>int</code></td>
        <td><p>The padding of the figure tight_layout. Defaults to 3.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the figure. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add text to the figure. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>The position of the text from the lower-left corner. Defaults to ("1%", "1%").</p></td>
        <td><code>(&#39;1%&#39;, &#39;1%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>fontsize</code></td>
        <td><code>int</code></td>
        <td><p>The font size of the text. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar to the figure. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>The color of the progress bar. Defaults to "blue".</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>The height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>dpi</code></td>
        <td><code>int</code></td>
        <td><p>The dpi of the figure. Defaults to 300.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>fps</code></td>
        <td><code>int</code></td>
        <td><p>The frames per second (fps) of the gif. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>The number of loops of the gif. Defaults to 0, infinite loop.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the gif to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>keep_png</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to keep the png files. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>open_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the geopandas.read_file() function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>plot_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the geopandas.GeoDataFrame.plot() function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/timelapse.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_gif</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="p">,</span>
    <span class="n">colname</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;1%&quot;</span><span class="p">,</span> <span class="s2">&quot;1%&quot;</span><span class="p">),</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">keep_png</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">plot_args</span><span class="o">=</span><span class="p">{},</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a vector to a gif. This function was inspired by by Johannes Uhl&#39;s shapefile2gif repo at</span>
<span class="sd">            https://github.com/johannesuhl/shapefile2gif. Credits to Johannes Uhl.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The input vector file. Can be a directory path or http URL, e.g., &quot;https://i.imgur.com/ZWSZC5z.gif&quot;</span>
<span class="sd">        out_gif (str): The output gif file.</span>
<span class="sd">        colname (str): The column name of the vector that contains numerical values.</span>
<span class="sd">        vmin (float, optional): The minimum value to filter the data. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to filter the data. Defaults to None.</span>
<span class="sd">        step (float, optional): The step to filter the data. Defaults to 1.</span>
<span class="sd">        facecolor (str, optional): The color to visualize the data. Defaults to &quot;black&quot;.</span>
<span class="sd">        figsize (tuple, optional): The figure size. Defaults to (10, 8).</span>
<span class="sd">        padding (int, optional): The padding of the figure tight_layout. Defaults to 3.</span>
<span class="sd">        title (str, optional): The title of the figure. Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add text to the figure. Defaults to True.</span>
<span class="sd">        xy (tuple, optional): The position of the text from the lower-left corner. Defaults to (&quot;1%&quot;, &quot;1%&quot;).</span>
<span class="sd">        fontsize (int, optional): The font size of the text. Defaults to 20.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar to the figure. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): The color of the progress bar. Defaults to &quot;blue&quot;.</span>
<span class="sd">        progress_bar_height (int, optional): The height of the progress bar. Defaults to 5.</span>
<span class="sd">        dpi (int, optional): The dpi of the figure. Defaults to 300.</span>
<span class="sd">        fps (int, optional): The frames per second (fps) of the gif. Defaults to 10.</span>
<span class="sd">        loop (int, optional): The number of loops of the gif. Defaults to 0, infinite loop.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the gif to mp4. Defaults to False.</span>
<span class="sd">        keep_png (bool, optional): Whether to keep the png files. Defaults to False.</span>
<span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to True.</span>
<span class="sd">        open_args (dict, optional): The arguments for the geopandas.read_file() function. Defaults to {}.</span>
<span class="sd">        plot_args (dict, optional): The arguments for the geopandas.GeoDataFrame.plot() function. Defaults to {}.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;tmp_png&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">open_args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">filename</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;filename must be a string or a geopandas.GeoDataFrame object.&quot;</span>
        <span class="p">)</span>

    <span class="n">bbox</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>

    <span class="k">if</span> <span class="n">colname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">colname</span><span class="si">}</span><span class="s2"> is not in the columns of the GeoDataFrame. It must be one of </span><span class="si">{</span><span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">values</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">options</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

    <span class="n">W</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># default text location is 5% width and 5% height of the image.</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;xy must be a tuple, e.g., (10, 10), (&#39;10%&#39;, &#39;10%&#39;)&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">W</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;xy is out of bounds. x must be within [0, </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s2">], and y must be within [0, </span><span class="si">{</span><span class="n">H</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">W</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">H</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The specified xy is invalid. It must be formatted like this (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;The specified xy is invalid. It must be formatted like this: (10, 10) or (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
        <span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="n">yrdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="p">]</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">yrdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_args</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmp_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">v</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

    <span class="n">png_to_gif</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">add_progress_bar</span><span class="p">:</span>
        <span class="n">add_progress_bar_to_gif</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">progress_bar_color</span><span class="p">,</span>
            <span class="n">progress_bar_height</span><span class="p">,</span>
            <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
        <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_png</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done. The GIF is saved to </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2021-11-07T04:02:50+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-11-07</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2021-11-07T04:02:50+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-11-07</span>
  </span>

    
    
    
  </aside>


  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2024 Qiusheng Wu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/giswqs" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@giswqs" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/giswqs" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/giswqs" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/@giswqs" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>